"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DateControl = exports.DateControlState = exports.DateControlValidations = exports.DateValidationFailReasonCode = void 0;
const tslib_1 = require("tslib");
const i18next_1 = tslib_1.__importDefault(require("i18next"));
const lodash_1 = tslib_1.__importDefault(require("lodash"));
const Strings_1 = require("../constants/Strings");
const Control_1 = require("../controls/Control");
const AmazonBuiltInSlotType_1 = require("../intents/AmazonBuiltInSlotType");
const GeneralControlIntent_1 = require("../intents/GeneralControlIntent");
const SingleValueControlIntent_1 = require("../intents/SingleValueControlIntent");
const ModelTypes_1 = require("../interactionModelGeneration/ModelTypes");
const Logger_1 = require("../logging/Logger");
const ContentActs_1 = require("../systemActs/ContentActs");
const InitiativeActs_1 = require("../systemActs/InitiativeActs");
const InputUtil_1 = require("../utils/InputUtil");
const Predicates_1 = require("../utils/Predicates");
const DateHelper_1 = require("./dateRangeControl/DateHelper");
const log = new Logger_1.Logger('AskSdkControls:DateControl');
/**
 * Reason codes for built-in validation rules.
 */
var DateValidationFailReasonCode;
(function (DateValidationFailReasonCode) {
    /**
     * The date must be in the past.
     */
    DateValidationFailReasonCode["PAST_DATE_ONLY"] = "pastDateOnly";
    /**
     * The date must be in the future.
     */
    DateValidationFailReasonCode["FUTURE_DATE_ONLY"] = "futureDateOnly";
})(DateValidationFailReasonCode = exports.DateValidationFailReasonCode || (exports.DateValidationFailReasonCode = {}));
/**
 * Built-in validation functions for use with DateControl
 */
var DateControlValidations;
(function (DateControlValidations) {
    /**
     * Validate that the date is in the past.
     * @param state - Control state
     * @param input - Input
     */
    DateControlValidations.PAST_DATE_ONLY = (state, input) => {
        const startDate = DateHelper_1.getStartDateOfRange(state.value);
        const startDateInUTC = DateHelper_1.getUTCDate(startDate);
        const now = new Date();
        if (startDateInUTC > now) {
            return {
                reasonCode: DateValidationFailReasonCode.PAST_DATE_ONLY,
                renderedReason: i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_VALIDATION_FAIL_PAST_DATE_ONLY')
            };
        }
        return true;
    };
    /**
     * Validate that the date is in the future.
     * @param state - Control state
     * @param input - Input
     */
    DateControlValidations.FUTURE_DATE_ONLY = (state, input) => {
        const endDate = DateHelper_1.getEndDateOfRange(state.value);
        const endDateInUTC = DateHelper_1.getUTCDate(endDate);
        const now = new Date();
        if (endDateInUTC < now) {
            return {
                reasonCode: DateValidationFailReasonCode.FUTURE_DATE_ONLY,
                renderedReason: i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_VALIDATION_FAIL_FUTURE_DATE_ONLY')
            };
        }
        return true;
    };
})(DateControlValidations = exports.DateControlValidations || (exports.DateControlValidations = {}));
/**
 * State tracked by a DateControl.
 */
class DateControlState {
    constructor() {
        /**
         * Tracks whether the value has been explicitly confirmed by the user.
         */
        this.isValueConfirmed = false;
    }
}
exports.DateControlState = DateControlState;
/**
 * A Control that obtains a single date from the user.
 *
 * Capabilities:
 * - Request a value
 * - Change a value
 * - Validate the value
 * - Confirm the value
 * - Infer the specific date for a partially specified date.
 *
 * Intents that can be handled:
 * - `GeneralControlIntent`: E.g. `"yes, update my birth date"`
 * - `AMAZON_DATE_ValueControlIntent`: E.g. "no change it to Tuesday".
 * - `AMAZON.YesIntent`, `AMAZON.NoIntent`
 */
class DateControl extends Control_1.Control {
    constructor(props) {
        super(props.id);
        this.state = new DateControlState();
        this.rawProps = props;
        this.props = DateControl.mergeWithDefaultProps(props);
    }
    static mergeWithDefaultProps(props) {
        const defaults = {
            id: 'dummy',
            prompts: {
                confirmValue: (act) => i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_CONFIRM_VALUE', { value: act.payload.value }),
                valueAffirmed: i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_VALUE_AFFIRMED'),
                valueDisaffirmed: i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_VALUE_DISAFFIRMED'),
                valueSet: i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_VALUE_SET'),
                valueChanged: (act) => i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_VALUE_CHANGED', { old: act.payload.previousValue, new: act.payload.value }),
                invalidValue: (act) => {
                    if (act.payload.renderedReason !== undefined) {
                        return i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_INVALID_VALUE_WITH_REASON', { reason: act.payload.renderedReason });
                    }
                    return i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_GENERAL_INVALID_VALUE');
                },
                requestValue: i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_REQUEST_VALUE'),
                requestChangedValue: i18next_1.default.t('DATE_CONTROL_DEFAULT_PROMPT_REQUEST_CHANGED_VALUE'),
            },
            reprompts: {
                confirmValue: (act) => i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_CONFIRM_VALUE', { value: act.payload.value }),
                valueAffirmed: i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_VALUE_AFFIRMED'),
                valueDisaffirmed: i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_VALUE_DISAFFIRMED'),
                valueSet: i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_VALUE_SET'),
                valueChanged: (act) => i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_VALUE_CHANGED', { old: act.payload.previousValue, new: act.payload.value }),
                invalidValue: (act) => {
                    if (act.payload.renderedReason !== undefined) {
                        return i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_INVALID_VALUE_WITH_REASON', { reason: act.payload.renderedReason });
                    }
                    return i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_GENERAL_INVALID_VALUE');
                },
                requestValue: i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_REQUEST_VALUE'),
                requestChangedValue: i18next_1.default.t('DATE_CONTROL_DEFAULT_REPROMPT_REQUEST_CHANGED_VALUE'),
            },
            interactionModel: {
                actions: {
                    set: [Strings_1.Strings.Action.Set],
                    change: [Strings_1.Strings.Action.Change],
                },
                targets: [Strings_1.Strings.Target.Date, Strings_1.Strings.Target.It]
            },
            validation: [],
            confirmationRequired: false,
            required: true
        };
        return lodash_1.default.merge(defaults, props);
    }
    // tsDoc - see Control
    canHandle(input) {
        return this.isSetWithValue(input)
            || this.isSetWithoutValue(input)
            || this.isChangeWithValue(input)
            || this.isChangeWithoutValue(input)
            || this.isBareValue(input)
            || this.isConfirmationAffirmed(input)
            || this.isConfirmationDisaffirmed(input);
    }
    isSetWithValue(input) {
        try {
            Predicates_1.okIf(InputUtil_1.InputUtil.isSingleValueControlIntent(input, AmazonBuiltInSlotType_1.AmazonBuiltInSlotType.DATE));
            const { feedback, action, target, valueStr } = SingleValueControlIntent_1.unpackSingleValueControlIntent(input.request.intent);
            Predicates_1.okIf(InputUtil_1.InputUtil.feedbackIsMatchOrUndefined(feedback, [Strings_1.Strings.Feedback.Affirm, Strings_1.Strings.Feedback.Disaffirm]));
            Predicates_1.okIf(InputUtil_1.InputUtil.actionIsMatch(action, this.props.interactionModel.actions.set));
            Predicates_1.okIf(InputUtil_1.InputUtil.targetIsMatchOrUndefined(target, this.props.interactionModel.targets));
            Predicates_1.okIf(InputUtil_1.InputUtil.valueStrDefined(valueStr));
            this.handleFunc = this.handleSetWithValue;
            return true;
        }
        catch (e) {
            return Predicates_1.falseIfGuardFailed(e);
        }
    }
    handleSetWithValue(input, resultBuilder) {
        const { valueStr } = SingleValueControlIntent_1.unpackSingleValueControlIntent(input.request.intent);
        this.setValue(valueStr);
        this.validateAndAddActs(input, resultBuilder, Strings_1.Strings.Action.Set);
        return;
    }
    isSetWithoutValue(input) {
        try {
            Predicates_1.okIf(InputUtil_1.InputUtil.isIntent(input, GeneralControlIntent_1.GeneralControlIntent.name));
            const { feedback, action, target } = GeneralControlIntent_1.unpackGeneralControlIntent(input.request.intent);
            Predicates_1.okIf(InputUtil_1.InputUtil.feedbackIsMatchOrUndefined(feedback, [Strings_1.Strings.Feedback.Affirm, Strings_1.Strings.Feedback.Disaffirm]));
            Predicates_1.okIf(InputUtil_1.InputUtil.actionIsMatch(action, this.props.interactionModel.actions.set));
            Predicates_1.okIf(InputUtil_1.InputUtil.targetIsMatchOrUndefined(target, this.props.interactionModel.targets));
            this.handleFunc = this.handleSetWithoutValue;
            return true;
        }
        catch (e) {
            return Predicates_1.falseIfGuardFailed(e);
        }
    }
    handleSetWithoutValue(input, resultBuilder) {
        this.askElicitationQuestion(input, resultBuilder, Strings_1.Strings.Action.Set);
        return;
    }
    /**
     * Test if the input is a valid change-action with a value provided.
     *
     * @param input - Input
     */
    isChangeWithValue(input) {
        try {
            Predicates_1.okIf(InputUtil_1.InputUtil.isSingleValueControlIntent(input, AmazonBuiltInSlotType_1.AmazonBuiltInSlotType.DATE));
            const { feedback, action, target, valueStr } = SingleValueControlIntent_1.unpackSingleValueControlIntent(input.request.intent);
            Predicates_1.okIf(InputUtil_1.InputUtil.feedbackIsMatchOrUndefined(feedback, [Strings_1.Strings.Feedback.Affirm, Strings_1.Strings.Feedback.Disaffirm]));
            Predicates_1.okIf(InputUtil_1.InputUtil.actionIsMatch(action, this.props.interactionModel.actions.change));
            Predicates_1.okIf(InputUtil_1.InputUtil.targetIsMatchOrUndefined(target, this.props.interactionModel.targets));
            Predicates_1.okIf(InputUtil_1.InputUtil.valueStrDefined(valueStr));
            this.handleFunc = this.handleChangeWithValue;
            return true;
        }
        catch (e) {
            return Predicates_1.falseIfGuardFailed(e);
        }
    }
    handleChangeWithValue(input, resultBuilder) {
        const { valueStr } = SingleValueControlIntent_1.unpackSingleValueControlIntent(input.request.intent);
        this.setValue(valueStr);
        this.validateAndAddActs(input, resultBuilder, Strings_1.Strings.Action.Change);
        return;
    }
    /**
     * Test if the input is a valid change-action without a value provided.
     *
     * @param input - Input
     */
    isChangeWithoutValue(input) {
        try {
            Predicates_1.okIf(InputUtil_1.InputUtil.isIntent(input, GeneralControlIntent_1.GeneralControlIntent.name));
            const { feedback, action, target } = GeneralControlIntent_1.unpackGeneralControlIntent(input.request.intent);
            Predicates_1.okIf(InputUtil_1.InputUtil.feedbackIsMatchOrUndefined(feedback, [Strings_1.Strings.Feedback.Affirm, Strings_1.Strings.Feedback.Disaffirm]));
            Predicates_1.okIf(InputUtil_1.InputUtil.actionIsMatch(action, this.props.interactionModel.actions.change));
            Predicates_1.okIf(InputUtil_1.InputUtil.targetIsMatchOrUndefined(target, this.props.interactionModel.targets));
            this.handleFunc = this.handleChangeWithoutValue;
            return true;
        }
        catch (e) {
            return Predicates_1.falseIfGuardFailed(e);
        }
    }
    handleChangeWithoutValue(input, resultBuilder) {
        this.askElicitationQuestion(input, resultBuilder, Strings_1.Strings.Action.Change);
        return;
    }
    /**
     * Test if the input is a DateControlIntent with just a date provided.
     * If we aren't asking a question it is assumed the user meant 'set value'.
     * @param input - Input
     */
    isBareValue(input) {
        try {
            Predicates_1.okIf(InputUtil_1.InputUtil.isSingleValueControlIntent(input, AmazonBuiltInSlotType_1.AmazonBuiltInSlotType.DATE));
            const { feedback, action, target, valueStr } = SingleValueControlIntent_1.unpackSingleValueControlIntent(input.request.intent);
            Predicates_1.okIf(InputUtil_1.InputUtil.feedbackIsUndefined(feedback));
            Predicates_1.okIf(InputUtil_1.InputUtil.actionIsUndefined(action));
            Predicates_1.okIf(InputUtil_1.InputUtil.targetIsMatchOrUndefined(target, this.props.interactionModel.targets));
            Predicates_1.okIf(InputUtil_1.InputUtil.valueStrDefined(valueStr));
            this.handleFunc = this.handleBareValue;
            return true;
        }
        catch (e) {
            return Predicates_1.falseIfGuardFailed(e);
        }
    }
    handleBareValue(input, resultBuilder) {
        var _a;
        const { valueStr } = SingleValueControlIntent_1.unpackSingleValueControlIntent(input.request.intent);
        this.setValue(valueStr);
        this.validateAndAddActs(input, resultBuilder, (_a = this.state.elicitationAction) !== null && _a !== void 0 ? _a : Strings_1.Strings.Action.Set);
        return;
    }
    isConfirmationAffirmed(input) {
        try {
            Predicates_1.okIf(InputUtil_1.InputUtil.isBareYes(input));
            Predicates_1.okIf(this.state.activeInitiativeAct === 'ConfirmValueAct');
            this.handleFunc = this.handleConfirmationAffirmed;
            return true;
        }
        catch (e) {
            return Predicates_1.falseIfGuardFailed(e);
        }
    }
    handleConfirmationAffirmed(input, resultBuilder) {
        this.state.activeInitiativeAct = undefined;
        this.state.isValueConfirmed = true;
        resultBuilder.addAct(new ContentActs_1.ValueConfirmedAct(this, { value: this.state.value }));
    }
    isConfirmationDisaffirmed(input) {
        try {
            Predicates_1.okIf(InputUtil_1.InputUtil.isBareNo(input));
            Predicates_1.okIf(this.state.activeInitiativeAct === 'ConfirmValueAct');
            this.handleFunc = this.handleConfirmationDisaffirmed;
            return true;
        }
        catch (e) {
            return Predicates_1.falseIfGuardFailed(e);
        }
    }
    handleConfirmationDisaffirmed(input, resultBuilder) {
        this.state.isValueConfirmed = false;
        this.state.activeInitiativeAct = undefined;
        resultBuilder.addAct(new ContentActs_1.ValueDisconfirmedAct(this, { value: this.state.value }));
        resultBuilder.addAct(new InitiativeActs_1.RequestValueAct(this));
    }
    // tsDoc - see Control
    async handle(input, resultBuilder) {
        log.debug(`DateControl[${this.id}]: handle(). Entering`);
        if (this.handleFunc === undefined) {
            const intent = input.request.intent;
            throw new Error(`${intent.name} can not be handled by ${this.constructor.name}.`);
        }
        this.handleFunc(input, resultBuilder);
        if (resultBuilder.hasInitiativeAct() !== true && this.canTakeInitiative(input) === true) {
            this.takeInitiative(input, resultBuilder);
        }
    }
    // tsDoc - see Control
    canTakeInitiative(input) {
        return this.wantsToConfirmValue(input)
            || this.wantsToFixInvalidValue(input)
            || this.wantsToElicitValue(input);
    }
    // tsDoc - see Control
    takeInitiative(input, resultBuilder) {
        if (this.initiativeFunc === undefined) {
            const errorMsg = 'DateControl: takeInitiative called but this.initiativeFunc is not set. canTakeInitiative() should be called first to set this.initiativeFunc.';
            log.error(errorMsg);
            throw new Error(errorMsg);
        }
        this.initiativeFunc(input, resultBuilder);
        return;
    }
    wantsToElicitValue(input) {
        if (this.state.value === undefined && this.evaluateBooleanProp(this.props.required, input)) {
            this.initiativeFunc = this.elicitValue;
            return true;
        }
        return false;
    }
    elicitValue(input, resultBuilder) {
        this.askElicitationQuestion(input, resultBuilder, Strings_1.Strings.Action.Set);
    }
    // public-for-testing
    askElicitationQuestion(input, resultBuilder, elicitationAction) {
        this.state.elicitationAction = elicitationAction;
        switch (elicitationAction) {
            case Strings_1.Strings.Action.Set:
                resultBuilder.addAct(new InitiativeActs_1.RequestValueAct(this));
                return;
            case Strings_1.Strings.Action.Change:
                resultBuilder.addAct(new InitiativeActs_1.RequestChangedValueAct(this, { currentValue: this.state.value }));
                return;
            default:
                throw new Error(`Unhandled. Unknown elicitationAction: ${elicitationAction}`);
        }
    }
    validateAndAddActs(input, resultBuilder, elicitationAction) {
        this.state.elicitationAction = elicitationAction;
        const validationResult = this.validate(input);
        if (validationResult === true) {
            if (elicitationAction === Strings_1.Strings.Action.Change) {
                // if elicitationAction == 'change', then the previousValue must be defined.
                if (this.state.previousValue !== undefined) {
                    resultBuilder.addAct(new ContentActs_1.ValueChangedAct(this, { previousValue: this.state.previousValue, value: this.state.value }));
                }
                else {
                    throw new Error('ValueChangedAct should only be used if there is an actual previous value');
                }
            }
            else {
                resultBuilder.addAct(new ContentActs_1.ValueSetAct(this, { value: this.state.value }));
            }
        }
        else {
            // feedback
            resultBuilder.addAct(new ContentActs_1.InvalidValueAct(this, {
                value: this.state.value,
                reasonCode: validationResult.reasonCode,
                renderedReason: validationResult.renderedReason
            }));
            this.askElicitationQuestion(input, resultBuilder, elicitationAction);
        }
        return;
    }
    wantsToConfirmValue(input) {
        if (this.state.value !== undefined && this.state.isValueConfirmed === false && this.evaluateBooleanProp(this.props.confirmationRequired, input)) {
            this.initiativeFunc = this.confirmValue;
            return true;
        }
        return false;
    }
    confirmValue(input, resultBuilder) {
        this.state.activeInitiativeAct = 'ConfirmValueAct';
        resultBuilder.addAct(new InitiativeActs_1.ConfirmValueAct(this, { value: this.state.value }));
    }
    wantsToFixInvalidValue(input) {
        if (this.state.value !== undefined && this.validate(input) !== true) {
            this.initiativeFunc = this.fixInvalidValue;
            return true;
        }
        return false;
    }
    fixInvalidValue(input, resultBuilder) {
        this.validateAndAddActs(input, resultBuilder, Strings_1.Strings.Action.Change);
    }
    validate(input) {
        const listOfValidationFunc = typeof (this.props.validation) === 'function' ? [this.props.validation] : this.props.validation;
        for (const validationFunction of listOfValidationFunc) {
            const validationResult = validationFunction(this.state, input);
            if (validationResult !== true) {
                log.debug(`DateControl.validate(): validation failed. Reason: ${JSON.stringify(validationResult, null, 2)}.`);
                return validationResult;
            }
        }
        return true;
    }
    /**
     * Directly set the value.
     *
     * @param value - Value, an ISO Date string
     */
    setValue(value) {
        this.state.previousValue = this.state.value;
        this.state.value = value;
        this.state.isValueConfirmed = false;
    }
    /**
     * Clear the state of this control.
     */
    clear() {
        this.state = new DateControlState();
    }
    // tsDoc - see Control
    renderAct(act, input, builder) {
        if (act instanceof InitiativeActs_1.RequestValueAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.requestValue, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.requestValue, input));
            const slotElicitation = generateSlotElicitation();
            builder.addElicitSlotDirective(slotElicitation.slotName, slotElicitation.intent);
        }
        else if (act instanceof ContentActs_1.ValueSetAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.valueSet, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.valueSet, input));
        }
        else if (act instanceof ContentActs_1.ValueChangedAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.valueChanged, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.valueChanged, input));
        }
        else if (act instanceof ContentActs_1.InvalidValueAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.invalidValue, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.invalidValue, input));
        }
        else if (act instanceof InitiativeActs_1.RequestChangedValueAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.requestChangedValue, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.requestChangedValue, input));
        }
        else if (act instanceof InitiativeActs_1.ConfirmValueAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.confirmValue, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.confirmValue, input));
        }
        else if (act instanceof ContentActs_1.ValueConfirmedAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.valueAffirmed, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.valueAffirmed, input));
        }
        else if (act instanceof ContentActs_1.ValueDisconfirmedAct) {
            builder.addPromptFragment(this.evaluatePromptProp(act, this.props.prompts.valueDisaffirmed, input));
            builder.addRepromptFragment(this.evaluatePromptProp(act, this.props.reprompts.valueDisaffirmed, input));
        }
        else {
            this.throwUnhandledActError(act);
        }
    }
    // tsDoc - see Control
    updateInteractionModel(generator, imData) {
        generator.addControlIntent(new GeneralControlIntent_1.GeneralControlIntent(), imData);
        generator.addControlIntent(new SingleValueControlIntent_1.SingleValueControlIntent(AmazonBuiltInSlotType_1.AmazonBuiltInSlotType.DATE), imData);
        generator.addYesAndNoIntents();
        if (this.props.interactionModel.targets.includes('date')) {
            generator.addValuesToSlotType(ModelTypes_1.SharedSlotType.TARGET, i18next_1.default.t('DATE_CONTROL_DEFAULT_SLOT_VALUES_TARGET_DATE', { returnObjects: true }));
        }
    }
    // tsDoc - see InteractionModelContributor
    getTargetIds() {
        return this.props.interactionModel.targets;
    }
}
exports.DateControl = DateControl;
/**
 * Creates an elicit-slot directive.
 *
 * - The intent specified is a `AMAZON_DATE_ValueControlIntent`
 * - The slot specified is the `AMAZON.DATE` slot.
 *
 * @param slotType - Slot type
 */
function generateSlotElicitation() {
    const intent = {
        name: SingleValueControlIntent_1.SingleValueControlIntent.intentName(AmazonBuiltInSlotType_1.AmazonBuiltInSlotType.DATE),
        slots: {
            "feedback": { name: "feedback", value: '', confirmationStatus: 'NONE' },
            "action": { name: "action", value: '', confirmationStatus: 'NONE' },
            "target": { name: "target", value: '', confirmationStatus: 'NONE' },
            "AMAZON.DATE": { name: "AMAZON.DATE", value: '', confirmationStatus: 'NONE' },
            "head": { name: "head", value: '', confirmationStatus: 'NONE' },
            "tail": { name: "tail", value: '', confirmationStatus: 'NONE' },
            "preposition": { name: "preposition", value: '', confirmationStatus: 'NONE' }
        },
        confirmationStatus: "NONE"
    };
    return {
        intent,
        slotName: AmazonBuiltInSlotType_1.AmazonBuiltInSlotType.DATE
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF0ZUNvbnRyb2wuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tbW9uQ29udHJvbHMvRGF0ZUNvbnRyb2wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQWFBLDhEQUE4QjtBQUM5Qiw0REFBdUI7QUFDdkIsa0RBQW9EO0FBQ3BELGlEQUEwRTtBQUsxRSw0RUFBeUU7QUFDekUsMEVBQW1HO0FBQ25HLGtGQUErRztBQUUvRyx5RUFBcUY7QUFDckYsOENBQTJDO0FBRTNDLDJEQUFtSTtBQUNuSSxpRUFBd0c7QUFJeEcsa0RBQStDO0FBQy9DLG9EQUErRDtBQUMvRCw4REFBbUc7QUFJbkcsTUFBTSxHQUFHLEdBQUcsSUFBSSxlQUFNLENBQUMsNEJBQTRCLENBQUMsQ0FBQztBQTZKckQ7O0dBRUc7QUFDSCxJQUFZLDRCQVVYO0FBVkQsV0FBWSw0QkFBNEI7SUFDcEM7O09BRUc7SUFDSCwrREFBK0IsQ0FBQTtJQUUvQjs7T0FFRztJQUNILG1FQUFtQyxDQUFBO0FBQ3ZDLENBQUMsRUFWVyw0QkFBNEIsR0FBNUIsb0NBQTRCLEtBQTVCLG9DQUE0QixRQVV2QztBQUVEOztHQUVHO0FBQ0gsSUFBaUIsc0JBQXNCLENBd0N0QztBQXhDRCxXQUFpQixzQkFBc0I7SUFFbkM7Ozs7T0FJRztJQUNVLHFDQUFjLEdBQTJCLENBQUMsS0FBdUIsRUFBRSxLQUFtQixFQUEyQixFQUFFO1FBRTVILE1BQU0sU0FBUyxHQUFHLGdDQUFtQixDQUFDLEtBQUssQ0FBQyxLQUFNLENBQUMsQ0FBQztRQUNwRCxNQUFNLGNBQWMsR0FBRyx1QkFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRTdDLE1BQU0sR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDdkIsSUFBSSxjQUFjLEdBQUcsR0FBRyxFQUFFO1lBQ3RCLE9BQU87Z0JBQ0gsVUFBVSxFQUFFLDRCQUE0QixDQUFDLGNBQWM7Z0JBQ3ZELGNBQWMsRUFBRSxpQkFBTyxDQUFDLENB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RUFBRSxFQUFFLGtCQUFrQixFQUFFLE1BQU0sRUFBRTtZQUMvRCxNQUFNLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxFQUFFO1lBQy9ELGFBQWEsRUFBRSxFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxrQkFBa0IsRUFBRSxNQUFNLEVBQUU7U0FDaEY7UUFDRCxrQkFBa0IsRUFBRSxNQUFNO0tBQzdCLENBQUM7SUFFRixPQUFPO1FBQ0gsTUFBTTtRQUNOLFFBQVEsRUFBRSw2Q0FBcUIsQ0FBQyxJQUFJO0tBQ3ZDLENBQUM7QUFDTixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAyMDIwIEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLlxuICogWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkXG4gKiBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXJcbiAqIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nXG4gKiBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IEludGVudCwgSW50ZW50UmVxdWVzdCB9IGZyb20gXCJhc2stc2RrLW1vZGVsXCI7XG5pbXBvcnQgaTE4bmV4dCBmcm9tICdpMThuZXh0JztcbmltcG9ydCBfIGZyb20gXCJsb2Rhc2hcIjtcbmltcG9ydCB7IFN0cmluZ3MgYXMgJCB9IGZyb20gXCIuLi9jb25zdGFudHMvU3RyaW5nc1wiO1xuaW1wb3J0IHsgQ29udHJvbCwgQ29udHJvbFByb3BzLCBDb250cm9sU3RhdGUgfSBmcm9tICcuLi9jb250cm9scy9Db250cm9sJztcbmltcG9ydCB7IENvbnRyb2xJbnB1dCB9IGZyb20gJy4uL2NvbnRyb2xzL0NvbnRyb2xJbnB1dCc7XG5pbXBvcnQgeyBDb250cm9sUmVzdWx0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRyb2xzL0NvbnRyb2xSZXN1bHQnO1xuaW1wb3J0IHsgSW50ZXJhY3Rpb25Nb2RlbENvbnRyaWJ1dG9yIH0gZnJvbSAnLi4vY29udHJvbHMvbWl4aW5zL0ludGVyYWN0aW9uTW9kZWxDb250cmlidXRvcic7XG5pbXBvcnQgeyBWYWxpZGF0aW9uUmVzdWx0IH0gZnJvbSAnLi4vY29udHJvbHMvVmFsaWRhdGlvblJlc3VsdCc7XG5pbXBvcnQgeyBBbWF6b25CdWlsdEluU2xvdFR5cGUgfSBmcm9tICcuLi9pbnRlbnRzL0FtYXpvbkJ1aWx0SW5TbG90VHlwZSc7XG5pbXBvcnQgeyBHZW5lcmFsQ29udHJvbEludGVudCwgdW5wYWNrR2VuZXJhbENvbnRyb2xJbnRlbnQgfSBmcm9tICcuLi9pbnRlbnRzL0dlbmVyYWxDb250cm9sSW50ZW50JztcbmltcG9ydCB7IFNpbmdsZVZhbHVlQ29udHJvbEludGVudCwgdW5wYWNrU2luZ2xlVmFsdWVDb250cm9sSW50ZW50IH0gZnJvbSAnLi4vaW50ZW50cy9TaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQnO1xuaW1wb3J0IHsgQ29udHJvbEludGVyYWN0aW9uTW9kZWxHZW5lcmF0b3IgfSBmcm9tICcuLi9pbnRlcmFjdGlvbk1vZGVsR2VuZXJhdGlvbi9Db250cm9sSW50ZXJhY3Rpb25Nb2RlbEdlbmVyYXRvcic7XG5pbXBvcnQgeyBNb2RlbERhdGEsIFNoYXJlZFNsb3RUeXBlIH0gZnJvbSAnLi4vaW50ZXJhY3Rpb25Nb2RlbEdlbmVyYXRpb24vTW9kZWxUeXBlcyc7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tIFwiLi4vbG9nZ2luZy9Mb2dnZXJcIjtcbmltcG9ydCB7IENvbnRyb2xSZXNwb25zZUJ1aWxkZXIgfSBmcm9tICcuLi9yZXNwb25zZUdlbmVyYXRpb24vQ29udHJvbFJlc3BvbnNlQnVpbGRlcic7XG5pbXBvcnQgeyBJbnZhbGlkVmFsdWVBY3QsIFZhbHVlQ2hhbmdlZEFjdCwgVmFsdWVDb25maXJtZWRBY3QsIFZhbHVlRGlzY29uZmlybWVkQWN0LCBWYWx1ZVNldEFjdCB9IGZyb20gXCIuLi9zeXN0ZW1BY3RzL0NvbnRlbnRBY3RzXCI7XG5pbXBvcnQgeyBDb25maXJtVmFsdWVBY3QsIFJlcXVlc3RDaGFuZ2VkVmFsdWVBY3QsIFJlcXVlc3RWYWx1ZUFjdCB9IGZyb20gXCIuLi9zeXN0ZW1BY3RzL0luaXRpYXRpdmVBY3RzXCI7XG5pbXBvcnQgeyBTeXN0ZW1BY3QgfSBmcm9tICcuLi9zeXN0ZW1BY3RzL1N5c3RlbUFjdCc7XG5pbXBvcnQgeyBTdHJpbmdPckxpc3QgfSBmcm9tICcuLi91dGlscy9CYXNpY1R5cGVzJztcbmltcG9ydCB7IERlZXBSZXF1aXJlZCB9IGZyb20gJy4uL3V0aWxzL0RlZXBSZXF1aXJlZCc7XG5pbXBvcnQgeyBJbnB1dFV0aWwgfSBmcm9tIFwiLi4vdXRpbHMvSW5wdXRVdGlsXCI7XG5pbXBvcnQgeyBmYWxzZUlmR3VhcmRGYWlsZWQsIG9rSWYgfSBmcm9tICcuLi91dGlscy9QcmVkaWNhdGVzJztcbmltcG9ydCB7IGdldEVuZERhdGVPZlJhbmdlLCBnZXRTdGFydERhdGVPZlJhbmdlLCBnZXRVVENEYXRlIH0gZnJvbSAnLi9kYXRlUmFuZ2VDb250cm9sL0RhdGVIZWxwZXInO1xuXG5cblxuY29uc3QgbG9nID0gbmV3IExvZ2dlcignQXNrU2RrQ29udHJvbHM6RGF0ZUNvbnRyb2wnKTtcblxuLyoqXG4gKiBQcm9wcyBmb3IgYSBEYXRlQ29udHJvbC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBEYXRlQ29udHJvbFByb3BzIGV4dGVuZHMgQ29udHJvbFByb3BzIHtcblxuICAgIC8qKlxuICAgICAqIFVuaXF1ZSBpZGVudGlmaWVyIGZvciBjb250cm9sIGluc3RhbmNlXG4gICAgICovXG4gICAgaWQ6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uKHMpIHRoYXQgZGV0ZXJtaW5lIGlmIHRoZSB2YWx1ZSBpcyB2YWxpZC5cbiAgICAgKlxuICAgICAqIERlZmF1bHQ6IGB0cnVlYCwgaS5lLiBhbnkgdmFsdWUgaXMgdmFsaWQuXG4gICAgICpcbiAgICAgKiBVc2FnZTpcbiAgICAgKiAtIFZhbGlkYXRpb24gZnVuY3Rpb25zIHJldHVybiBlaXRoZXIgYHRydWVgIG9yIGEgYFZhbGlkYXRpb25SZXN1bHRgIHRvXG4gICAgICogICAgZGVzY3JpYmUgd2hhdCB2YWxpZGF0aW9uIGZhaWxlZC5cbiAgICAgKlxuICAgICAqIC0gQ29tbW9uIHZhbGlkYXRpb24gZnVuY3Rpb25zIGFyZSBkZWZpbmVkIGluIHRoZSBgRGF0ZUNvbnRyb2xWYWxpZGF0aW9uc2AgbmFtZXNwYWNlXG4gICAgICogICB3aGljaCBjYW4gYmUgYWRkZWQgZGlyZWN0bHkgdG8gdGhpcyBwcm9wLiBlLmcuOlxuICAgICAqIGBgYFxuICAgICAqIHZhbGlkOiBEYXRlQ29udHJvbFZhbGlkYXRpb25zLkZVVFVSRV9EQVRFX09OTFksXG4gICAgICogYGBgXG4gICAgICovXG4gICAgdmFsaWRhdGlvbj86IERhdGVWYWxpZGF0aW9uRnVuY3Rpb24gfCBEYXRlVmFsaWRhdGlvbkZ1bmN0aW9uW107XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBDb250cm9sIG11c3Qgb2J0YWluIGEgdmFsdWUuXG4gICAgICpcbiAgICAgKiBJZiBgdHJ1ZWA6XG4gICAgICogIC0gdGhlIENvbnRyb2wgcmVwb3J0IGlzUmVhZHkoKSA9IGZhbHNlIGlmIG5vIHZhbHVlIGhhcyBiZWVuIG9idGFpbmVkLlxuICAgICAqICAtIHRoZSBjb250cm9sIHdpbGwgdGFrZSB0aGUgaW5pdGlhdGl2ZSB3aGVuIGdpdmVuIHRoZSBvcHBvcnR1bml0eS5cbiAgICAgKi9cbiAgICByZXF1aXJlZD86IGJvb2xlYW4gfCAoKGlucHV0OiBDb250cm9sSW5wdXQpID0+IGJvb2xlYW4pO1xuXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgQ29udHJvbCBoYXMgdG8gb2J0YWluIGV4cGxpY2l0IGNvbmZpcm1hdGlvbiBvZiB0aGUgdmFsdWUuXG4gICAgICpcbiAgICAgKiBJZiBgdHJ1ZWA6XG4gICAgICogIC0gdGhlIENvbnRyb2wgd2lsbCByZXBvcnQgYGlzUmVhZHkoKSA9IGZhbHNlYCBpZiB0aGUgdmFsdWUgaGFzIG5vdCBiZWVuXG4gICAgICogICAgZXhwbGljaXRseSBjb25maXJtZWQgYXMgY29ycmVjdCBieSB1c2VyLlxuICAgICAqICAtIHRoZSBDb250cm9sIHdpbGwgdGFrZSB0aGUgaW5pdGlhdGl2ZSB3aGVuIGdpdmVuIHRoZSBvcHBvcnR1bml0eS5cbiAgICAgKi9cbiAgICBjb25maXJtYXRpb25SZXF1aXJlZD86IGJvb2xlYW4gfCAoKGlucHV0OiBDb250cm9sSW5wdXQpID0+IGJvb2xlYW4pO1xuXG4gICAgLyoqXG4gICAgICogUHJvcHMgdG8gY3VzdG9taXplIHRoZSBwcm9tcHQgZnJhZ21lbnRzIHRoYXQgd2lsbCBiZSBhZGRlZCBieVxuICAgICAqIGB0aGlzLnJlbmRlckFjdCgpYC5cbiAgICAgKi9cbiAgICBwcm9tcHRzPzogRGF0ZUNvbnRyb2xQcm9tcHRQcm9wcztcblxuICAgIC8qKlxuICAgICAqIFByb3BzIHRvIGN1c3RvbWl6ZSB0aGUgcmVwcm9tcHQgZnJhZ21lbnRzIHRoYXQgd2lsbCBiZSBhZGRlZCBieVxuICAgICAqIGB0aGlzLnJlbmRlckFjdCgpYC5cbiAgICAgKi9cbiAgICByZXByb21wdHM/OiBEYXRlQ29udHJvbFByb21wdFByb3BzO1xuXG4gICAgLyoqXG4gICAgICogUHJvcHMgdG8gY3VzdG9taXplIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiB0aGUgY29udHJvbCBhbmQgdGhlXG4gICAgICogaW50ZXJhY3Rpb24gbW9kZWwuXG4gICAgICovXG4gICAgaW50ZXJhY3Rpb25Nb2RlbD86IERhdGVDb250cm9sSW50ZXJhY3Rpb25Nb2RlbFByb3BzO1xufVxuXG4vKipcbiAqIFZhbHVlQ29udHJvbCB2YWxpZGF0aW9uIGZ1bmN0aW9uXG4gKi9cbmV4cG9ydCB0eXBlIERhdGVWYWxpZGF0aW9uRnVuY3Rpb24gPSAoc3RhdGU6IERhdGVDb250cm9sU3RhdGUsIGlucHV0OiBDb250cm9sSW5wdXQpID0+IHRydWUgfCBWYWxpZGF0aW9uUmVzdWx0O1xuXG4vKipcbiAqIE1hcHBpbmcgb2YgYWN0aW9uIHNsb3QgdmFsdWVzIHRvIHRoZSBiZWhhdmlvcnMgdGhhdCB0aGlzIGNvbnRyb2wgc3VwcG9ydHMuXG4gKlxuICogQmVoYXZpb3I6XG4gKiAtIFRoaXMgY29udHJvbCB3aWxsIG5vdCBoYW5kbGUgYW4gaW5wdXQgaWYgdGhlIGFjdGlvbi1zbG90IGlzIGZpbGxlZCB3aXRoIGFuXG4gKiAgIHZhbHVlIHdob3NlIElEIGlzIG5vdCBhc3NvY2lhdGVkIHdpdGggYSBjYXBhYmlsaXR5LlxuICovXG5leHBvcnQgdHlwZSBEYXRlQ29udHJvbEFjdGlvblByb3BzID0ge1xuICAgIC8qKlxuICAgICAqIEFjdGlvbiBzbG90IHZhbHVlIElEcyB0aGF0IGFyZSBhc3NvY2lhdGVkIHdpdGggdGhlIFwic2V0IHZhbHVlXCIgY2FwYWJpbGl0eS5cbiAgICAgKlxuICAgICAqIERlZmF1bHQ6IFsnYnVpbHRpbl9zZXQnXVxuICAgICAqL1xuICAgIHNldD86IHN0cmluZ1tdO1xuXG4gICAgLyoqXG4gICAgICogQWN0aW9uIHNsb3QgdmFsdWUgSURzIHRoYXQgYXJlIGFzc29jaWF0ZWQgd2l0aCB0aGUgXCJjaGFuZ2UgdmFsdWVcIiBjYXBhYmlsaXR5LlxuICAgICAqXG4gICAgICogRGVmYXVsdCBbJ2J1aWx0aW5fY2hhbmdlJ11cbiAgICAgKi9cbiAgICBjaGFuZ2U/OiBzdHJpbmdbXTtcbn07XG5cbi8qKlxuICogUHJvcHMgYXNzb2NpYXRlZCB3aXRoIHRoZSBpbnRlcmFjdGlvbiBtb2RlbC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBEYXRlQ29udHJvbEludGVyYWN0aW9uTW9kZWxQcm9wcyB7XG4gICAgLyoqXG4gICAgICogVGFyZ2V0LXNsb3QgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIENvbnRyb2wuXG4gICAgICpcbiAgICAgKiBUYXJnZXRzIGFzc29jaWF0ZSB1dHRlcmFuY2VzIHRvIGEgY29udHJvbC4gRm9yIGV4YW1wbGUsIGlmIHRoZSB1c2VyIHNheXNcbiAgICAgKiBcImNoYW5nZSB0aGUgdGltZVwiLCBpdCBpcyBwYXJzZWQgYXMgYSBgR2VuZXJhbENvbnRyb2xJbnRlbnRgIHdpdGggc2xvdFxuICAgICAqIHZhbHVlcyBgYWN0aW9uID0gY2hhbmdlYCBhbmQgYHRhcmdldCA9IHRpbWVgLiAgT25seSBjb250cm9scyB0aGF0IGFyZVxuICAgICAqIHJlZ2lzdGVyZWQgd2l0aCB0aGUgYHRpbWVgIHRhcmdldCBzaG91bGQgb2ZmZXIgdG8gaGFuZGxlIHRoaXMgaW50ZW50LlxuICAgICAqXG4gICAgICogRGVmYXVsdDogWydidWlsdGluX2RhdGUnLCAnYnVpbHRpbl9pdCddXG4gICAgICpcbiAgICAgKiBVc2FnZTpcbiAgICAgKiAtIElmIHRoaXMgcHJvcCBpcyBkZWZpbmVkLCBpdCByZXBsYWNlcyB0aGUgZGVmYXVsdDsgaXQgaXMgbm90IGFkZGl0aXZlXG4gICAgICogICB0aGUgZGVmYXVsdHMuICBUbyBhZGQgYW4gYWRkaXRpb25hbCB0YXJnZXQgdG8gdGhlIGRlZmF1bHRzLCBjb3B5IHRoZVxuICAgICAqICAgZGVmYXVsdHMgYW5kIGFtZW5kLlxuICAgICAqIC0gQSBjb250cm9sIGNhbiBiZSBhc3NvY2lhdGVkIHdpdGggbWFueSB0YXJnZXQtc2xvdC12YWx1ZXMsIGVnIFsnZGF0ZScsXG4gICAgICogICAnc3RhcnREYXRlJywgJ2V2ZW50U3RhcnREYXRlJywgJ3ZhY2F0aW9uU3RhcnQnXVxuICAgICAqIC0gSXQgaXMgYSBnb29kIGlkZWEgdG8gYXNzb2NpYXRlIHdpdGggZ2VuZXJhbCB0YXJnZXRzIChlLmcuIGRhdGUpIGFuZFxuICAgICAqICAgYWxzbyB3aXRoIHNwZWNpZmljIHRhcmdldHMgKGUuZy4gdmFjYXRpb25TdGFydCkgc28gdGhhdCB0aGUgdXNlciBjYW5cbiAgICAgKiAgIHNheSBlaXRoZXIgZ2VuZXJhbCBvciBzcGVjaWZpYyB0aGluZ3MuICBlLmcuICdjaGFuZ2UgdGhlIGRhdGUgdG9cbiAgICAgKiAgIFR1ZXNkYXknLCBvciAnSSB3YW50IG15IHZhY2F0aW9uIHRvIHN0YXJ0IG9uIFR1ZXNkYXknLlxuICAgICAqIC0gVGhlIGFzc29jaWF0aW9uIGRvZXMgbm90IGhhdmUgdG8gYmUgZXhjbHVzaXZlLCBhbmQgZ2VuZXJhbCB0YXJnZXQgc2xvdFxuICAgICAqICAgdmFsdWVzIHdpbGwgb2Z0ZW4gYmUgYXNzb2NpYXRlZCB3aXRoIG1hbnkgY29udHJvbHMuIEluIHNpdHVhdGlvbnMgd2hlcmVcbiAgICAgKiAgIHRoZXJlIGlzIGFtYmlndWl0eSBhYm91dCB3aGF0IHRoZSB1c2VyIGlzIHJlZmVycmluZyB0bywgdGhlIHBhcmVudFxuICAgICAqICAgY29udHJvbHMgbXVzdCByZXNvbHZlIHRoZSBjb25mdXNpb24uXG4gICAgICogLSBUaGUgJ2J1aWx0aW5fKicgSURzIGFyZSBhc3NvY2lhdGVkIHdpdGggZGVmYXVsdCBpbnRlcmFjdGlvbiBtb2RlbCBkYXRhXG4gICAgICogICAod2hpY2ggY2FuIGJlIGV4dGVuZGVkIGFzIGRlc2lyZWQpLiBBbnkgb3RoZXIgSURzIHdpbGwgcmVxdWlyZSBhIGZ1bGxcbiAgICAgKiAgIGRlZmluaXRpb24gb2YgdGhlIGFsbG93ZWQgc3lub255bXMgaW4gdGhlIGludGVyYWN0aW9uIG1vZGVsLlxuICAgICAqXG4gICAgICogQ29udHJvbCBiZWhhdmlvcjpcbiAgICAgKiAtIEEgY29udHJvbCB3aWxsIG5vdCBoYW5kbGUgYW4gaW5wdXQgdGhhdCBtZW50aW9ucyBhIHRhcmdldCB0aGF0IGlzIG5vdFxuICAgICAqICAgcmVnaXN0ZXJlZCBieSB0aGlzIHByb3AuXG4gICAgICpcbiAgICAgKi9cbiAgICB0YXJnZXRzPzogc3RyaW5nW107XG5cbiAgICAvKipcbiAgICAgKiBBY3Rpb24gc2xvdC12YWx1ZXMgYXNzb2NpYXRlZCB0byB0aGUgY29udHJvbCdzIGNhcGFiaWxpdGllcy5cbiAgICAgKlxuICAgICAqIEFjdGlvbiBzbG90LXZhbHVlcyBhc3NvY2lhdGUgdXR0ZXJhbmNlcyB0byBhIGNvbnRyb2wuIEZvciBleGFtcGxlLCBpZiB0aGVcbiAgICAgKiB1c2VyIHNheXMgXCJjaGFuZ2UgdGhlIHRpbWVcIiwgaXQgaXMgcGFyc2VkIGFzIGEgYEdlbmVyYWxDb250cm9sSW50ZW50YFxuICAgICAqIHdpdGggc2xvdCB2YWx1ZXMgYGFjdGlvbiA9IGNoYW5nZWAgYW5kIGB0YXJnZXQgPSB0aW1lYC4gIE9ubHkgY29udHJvbHNcbiAgICAgKiB0aGF0IGFyZSByZWdpc3RlcmVkIHdpdGggdGhlIGBjaGFuZ2VgIGFjdGlvbiBzaG91bGQgb2ZmZXIgdG8gaGFuZGxlIHRoaXNcbiAgICAgKiBpbnRlbnQuXG4gICAgICpcbiAgICAgKiBVc2FnZTpcbiAgICAgKiAgLSBUaGlzIGFsbG93cyB1c2VycyB0byByZWZlciB0byBhbiBhY3Rpb24gdXNpbmcgbW9yZSBkb21haW4tYXBwcm9wcmlhdGVcbiAgICAgKiAgICB3b3Jkcy4gRm9yIGV4YW1wbGUsIGEgdXNlciBtaWdodCBsaWtlIHRvIHNheSAnc2hvdyB0d28gaXRlbXMnIHJhdGhlclxuICAgICAqICAgIHRoYXQgJ3NldCBpdGVtIGNvdW50IHRvIHR3bycuICBUbyBhY2hpZXZlIHRoaXMsIGluY2x1ZGUgdGhlXG4gICAgICogICAgc2xvdC12YWx1ZS1pZCAnc2hvdycgaW4gdGhlIGxpc3QgYXNzb2NpYXRlZCB3aXRoIHRoZSAnc2V0JyBjYXBhYmlsaXR5XG4gICAgICogICAgYW5kIGVuc3VyZSB0aGUgaW50ZXJhY3Rpb24tbW9kZWwgaW5jbHVkZXMgYW4gYWN0aW9uIHNsb3QgdmFsdWUgd2l0aFxuICAgICAqICAgIGlkPXNob3cgYW5kIGFwcHJvcHJpYXRlIHN5bm9ueW1zLlxuICAgICAqICAtIFRoZSAnYnVpbHRpbl8qJyBJRHMgYXJlIGFzc29jaWF0ZWQgd2l0aCBkZWZhdWx0IGludGVyYWN0aW9uIG1vZGVsIGRhdGFcbiAgICAgKiAgICAod2hpY2ggY2FuIGJlIGV4dGVuZGVkIGFzIGRlc2lyZWQpLiBBbnkgb3RoZXIgSURzIHdpbGwgcmVxdWlyZSBhIGZ1bGxcbiAgICAgKiAgICBkZWZpbml0aW9uIG9mIHRoZSBhbGxvd2VkIHN5bm9ueW1zIGluIHRoZSBpbnRlcmFjdGlvbiBtb2RlbC5cbiAgICAgKi9cbiAgICBhY3Rpb25zPzogRGF0ZUNvbnRyb2xBY3Rpb25Qcm9wcztcbn1cblxuLyoqXG4gKiBSZWFzb24gY29kZXMgZm9yIGJ1aWx0LWluIHZhbGlkYXRpb24gcnVsZXMuXG4gKi9cbmV4cG9ydCBlbnVtIERhdGVWYWxpZGF0aW9uRmFpbFJlYXNvbkNvZGUge1xuICAgIC8qKlxuICAgICAqIFRoZSBkYXRlIG11c3QgYmUgaW4gdGhlIHBhc3QuXG4gICAgICovXG4gICAgUEFTVF9EQVRFX09OTFkgPSAncGFzdERhdGVPbmx5JyxcblxuICAgIC8qKlxuICAgICAqIFRoZSBkYXRlIG11c3QgYmUgaW4gdGhlIGZ1dHVyZS5cbiAgICAgKi9cbiAgICBGVVRVUkVfREFURV9PTkxZID0gJ2Z1dHVyZURhdGVPbmx5Jyxcbn1cblxuLyoqXG4gKiBCdWlsdC1pbiB2YWxpZGF0aW9uIGZ1bmN0aW9ucyBmb3IgdXNlIHdpdGggRGF0ZUNvbnRyb2xcbiAqL1xuZXhwb3J0IG5hbWVzcGFjZSBEYXRlQ29udHJvbFZhbGlkYXRpb25zIHtcblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHRoYXQgdGhlIGRhdGUgaXMgaW4gdGhlIHBhc3QuXG4gICAgICogQHBhcmFtIHN0YXRlIC0gQ29udHJvbCBzdGF0ZVxuICAgICAqIEBwYXJhbSBpbnB1dCAtIElucHV0XG4gICAgICovXG4gICAgZXhwb3J0IGNvbnN0IFBBU1RfREFURV9PTkxZOiBEYXRlVmFsaWRhdGlvbkZ1bmN0aW9uID0gKHN0YXRlOiBEYXRlQ29udHJvbFN0YXRlLCBpbnB1dDogQ29udHJvbElucHV0KTogdHJ1ZSB8IFZhbGlkYXRpb25SZXN1bHQgPT4ge1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGdldFN0YXJ0RGF0ZU9mUmFuZ2Uoc3RhdGUudmFsdWUhKTtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlSW5VVEMgPSBnZXRVVENEYXRlKHN0YXJ0RGF0ZSk7XG5cbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgaWYgKHN0YXJ0RGF0ZUluVVRDID4gbm93KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlYXNvbkNvZGU6IERhdGVWYWxpZGF0aW9uRmFpbFJlYXNvbkNvZGUuUEFTVF9EQVRFX09OTFksXG4gICAgICAgICAgICAgICAgcmVuZGVyZWRSZWFzb246IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUFJPTVBUX1ZBTElEQVRJT05fRkFJTF9QQVNUX0RBVEVfT05MWScpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRoZSBkYXRlIGlzIGluIHRoZSBmdXR1cmUuXG4gICAgICogQHBhcmFtIHN0YXRlIC0gQ29udHJvbCBzdGF0ZVxuICAgICAqIEBwYXJhbSBpbnB1dCAtIElucHV0XG4gICAgICovXG4gICAgZXhwb3J0IGNvbnN0IEZVVFVSRV9EQVRFX09OTFk6IERhdGVWYWxpZGF0aW9uRnVuY3Rpb24gPSAoc3RhdGU6IERhdGVDb250cm9sU3RhdGUsIGlucHV0OiBDb250cm9sSW5wdXQpOiB0cnVlIHwgVmFsaWRhdGlvblJlc3VsdCA9PiB7XG4gICAgICAgIGNvbnN0IGVuZERhdGUgPSBnZXRFbmREYXRlT2ZSYW5nZShzdGF0ZS52YWx1ZSEpO1xuICAgICAgICBjb25zdCBlbmREYXRlSW5VVEMgPSBnZXRVVENEYXRlKGVuZERhdGUpO1xuXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGlmIChlbmREYXRlSW5VVEMgPCBub3cpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVhc29uQ29kZTogRGF0ZVZhbGlkYXRpb25GYWlsUmVhc29uQ29kZS5GVVRVUkVfREFURV9PTkxZLFxuICAgICAgICAgICAgICAgIHJlbmRlcmVkUmVhc29uOiBpMThuZXh0LnQoJ0RBVEVfQ09OVFJPTF9ERUZBVUxUX1BST01QVF9WQUxJREFUSU9OX0ZBSUxfRlVUVVJFX0RBVEVfT05MWScpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG59XG5cbi8qKlxuICogUHJvcHMgdG8gY3VzdG9taXplIHRoZSBwcm9tcHQgZnJhZ21lbnRzIHRoYXQgd2lsbCBiZSBhZGRlZCBieVxuICogYHRoaXMucmVuZGVyQWN0KClgLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGVDb250cm9sUHJvbXB0UHJvcHMge1xuICAgIHZhbHVlU2V0PzogU3RyaW5nT3JMaXN0IHwgKChhY3Q6IFZhbHVlU2V0QWN0PG51bWJlcj4sIGlucHV0OiBDb250cm9sSW5wdXQpID0+IFN0cmluZ09yTGlzdCk7XG4gICAgdmFsdWVDaGFuZ2VkPzogU3RyaW5nT3JMaXN0IHwgKChhY3Q6IFZhbHVlQ2hhbmdlZEFjdDxudW1iZXI+LCBpbnB1dDogQ29udHJvbElucHV0KSA9PiBTdHJpbmdPckxpc3QpO1xuICAgIGludmFsaWRWYWx1ZT86IFN0cmluZ09yTGlzdCB8ICgoYWN0OiBJbnZhbGlkVmFsdWVBY3Q8bnVtYmVyPiwgaW5wdXQ6IENvbnRyb2xJbnB1dCkgPT4gU3RyaW5nT3JMaXN0KTtcbiAgICByZXF1ZXN0VmFsdWU/OiBTdHJpbmdPckxpc3QgfCAoKGFjdDogUmVxdWVzdFZhbHVlQWN0LCBpbnB1dDogQ29udHJvbElucHV0KSA9PiBTdHJpbmdPckxpc3QpO1xuICAgIHJlcXVlc3RDaGFuZ2VkVmFsdWU/OiBTdHJpbmdPckxpc3QgfCAoKGFjdDogUmVxdWVzdENoYW5nZWRWYWx1ZUFjdCwgaW5wdXQ6IENvbnRyb2xJbnB1dCkgPT4gU3RyaW5nT3JMaXN0KTtcbiAgICBjb25maXJtVmFsdWU/OiBTdHJpbmdPckxpc3QgfCAoKGFjdDogQ29uZmlybVZhbHVlQWN0PG51bWJlcj4sIGlucHV0OiBDb250cm9sSW5wdXQpID0+IFN0cmluZ09yTGlzdCk7XG4gICAgdmFsdWVEaXNhZmZpcm1lZD86IFN0cmluZ09yTGlzdCB8ICgoYWN0OiBWYWx1ZURpc2NvbmZpcm1lZEFjdDxudW1iZXI+LCBpbnB1dDogQ29udHJvbElucHV0KSA9PiBTdHJpbmdPckxpc3QpO1xuICAgIHZhbHVlQWZmaXJtZWQ/OiBTdHJpbmdPckxpc3QgfCAoKGFjdDogVmFsdWVDb25maXJtZWRBY3Q8bnVtYmVyPiwgaW5wdXQ6IENvbnRyb2xJbnB1dCkgPT4gU3RyaW5nT3JMaXN0KTtcbn1cblxuLyoqXG4gKiBTdGF0ZSB0cmFja2VkIGJ5IGEgRGF0ZUNvbnRyb2wuXG4gKi9cbmV4cG9ydCBjbGFzcyBEYXRlQ29udHJvbFN0YXRlIGltcGxlbWVudHMgQ29udHJvbFN0YXRlIHtcblxuICAgIC8qKlxuICAgICAqIFRoZSB2YWx1ZSwgYW4gSVNPIGRhdGUgc3RyaW5nLlxuICAgICAqL1xuICAgIHZhbHVlPzogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVHJhY2tzIGlmIHRoZSBjb250cm9sIGlzIGFjdGl2ZWx5IGFza2luZyB0aGUgdXNlciB0byBzZXQgb3IgY2hhbmdlIHRoZSB2YWx1ZS5cbiAgICAgKi9cbiAgICBlbGljaXRhdGlvbkFjdGlvbj86IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIFRyYWNrcyB3aGV0aGVyIHRoZSB2YWx1ZSBoYXMgYmVlbiBleHBsaWNpdGx5IGNvbmZpcm1lZCBieSB0aGUgdXNlci5cbiAgICAgKi9cbiAgICBpc1ZhbHVlQ29uZmlybWVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcHJldmlvdXMgdmFsdWUuXG4gICAgICovXG4gICAgcHJldmlvdXNWYWx1ZT86IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIFRyYWNrcyB0aGUgbGFzdCBpbml0aWF0aXZlIGFjdCBmcm9tIHRoZSBjb250cm9sXG4gICAgICovXG4gICAgYWN0aXZlSW5pdGlhdGl2ZUFjdD86IHN0cmluZztcblxufVxuXG4vKipcbiAqIEEgQ29udHJvbCB0aGF0IG9idGFpbnMgYSBzaW5nbGUgZGF0ZSBmcm9tIHRoZSB1c2VyLlxuICpcbiAqIENhcGFiaWxpdGllczpcbiAqIC0gUmVxdWVzdCBhIHZhbHVlXG4gKiAtIENoYW5nZSBhIHZhbHVlXG4gKiAtIFZhbGlkYXRlIHRoZSB2YWx1ZVxuICogLSBDb25maXJtIHRoZSB2YWx1ZVxuICogLSBJbmZlciB0aGUgc3BlY2lmaWMgZGF0ZSBmb3IgYSBwYXJ0aWFsbHkgc3BlY2lmaWVkIGRhdGUuXG4gKlxuICogSW50ZW50cyB0aGF0IGNhbiBiZSBoYW5kbGVkOlxuICogLSBgR2VuZXJhbENvbnRyb2xJbnRlbnRgOiBFLmcuIGBcInllcywgdXBkYXRlIG15IGJpcnRoIGRhdGVcImBcbiAqIC0gYEFNQVpPTl9EQVRFX1ZhbHVlQ29udHJvbEludGVudGA6IEUuZy4gXCJubyBjaGFuZ2UgaXQgdG8gVHVlc2RheVwiLlxuICogLSBgQU1BWk9OLlllc0ludGVudGAsIGBBTUFaT04uTm9JbnRlbnRgXG4gKi9cbmV4cG9ydCBjbGFzcyBEYXRlQ29udHJvbCBleHRlbmRzIENvbnRyb2wgaW1wbGVtZW50cyBJbnRlcmFjdGlvbk1vZGVsQ29udHJpYnV0b3Ige1xuXG4gICAgc3RhdGU6IERhdGVDb250cm9sU3RhdGUgPSBuZXcgRGF0ZUNvbnRyb2xTdGF0ZSgpO1xuXG4gICAgcHJpdmF0ZSByYXdQcm9wczogRGF0ZUNvbnRyb2xQcm9wcztcbiAgICBwcml2YXRlIHByb3BzOiBEZWVwUmVxdWlyZWQ8RGF0ZUNvbnRyb2xQcm9wcz47XG4gICAgcHJpdmF0ZSBoYW5kbGVGdW5jPzogKGlucHV0OiBDb250cm9sSW5wdXQsIHJlc3VsdEJ1aWxkZXI6IENvbnRyb2xSZXN1bHRCdWlsZGVyKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgaW5pdGlhdGl2ZUZ1bmM/OiAoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogRGF0ZUNvbnRyb2xQcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcy5pZCk7XG4gICAgICAgIHRoaXMucmF3UHJvcHMgPSBwcm9wcztcbiAgICAgICAgdGhpcy5wcm9wcyA9IERhdGVDb250cm9sLm1lcmdlV2l0aERlZmF1bHRQcm9wcyhwcm9wcyk7XG4gICAgfVxuXG4gICAgc3RhdGljIG1lcmdlV2l0aERlZmF1bHRQcm9wcyhwcm9wczogRGF0ZUNvbnRyb2xQcm9wcyk6IERlZXBSZXF1aXJlZDxEYXRlQ29udHJvbFByb3BzPiB7XG5cbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IERlZXBSZXF1aXJlZDxEYXRlQ29udHJvbFByb3BzPiA9XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAnZHVtbXknLFxuICAgICAgICAgICAgcHJvbXB0czoge1xuICAgICAgICAgICAgICAgIGNvbmZpcm1WYWx1ZTogKGFjdCkgPT4gaTE4bmV4dC50KCdEQVRFX0NPTlRST0xfREVGQVVMVF9QUk9NUFRfQ09ORklSTV9WQUxVRScsIHsgdmFsdWU6IGFjdC5wYXlsb2FkLnZhbHVlIH0pLFxuICAgICAgICAgICAgICAgIHZhbHVlQWZmaXJtZWQ6IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUFJPTVBUX1ZBTFVFX0FGRklSTUVEJyksXG4gICAgICAgICAgICAgICAgdmFsdWVEaXNhZmZpcm1lZDogaTE4bmV4dC50KCdEQVRFX0NPTlRST0xfREVGQVVMVF9QUk9NUFRfVkFMVUVfRElTQUZGSVJNRUQnKSxcbiAgICAgICAgICAgICAgICB2YWx1ZVNldDogaTE4bmV4dC50KCdEQVRFX0NPTlRST0xfREVGQVVMVF9QUk9NUFRfVkFMVUVfU0VUJyksXG4gICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkOiAoYWN0KSA9PiBpMThuZXh0LnQoJ0RBVEVfQ09OVFJPTF9ERUZBVUxUX1BST01QVF9WQUxVRV9DSEFOR0VEJywgeyBvbGQ6IGFjdC5wYXlsb2FkLnByZXZpb3VzVmFsdWUsIG5ldzogYWN0LnBheWxvYWQudmFsdWUgfSksXG4gICAgICAgICAgICAgICAgaW52YWxpZFZhbHVlOiAoYWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3QucGF5bG9hZC5yZW5kZXJlZFJlYXNvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTE4bmV4dC50KCdEQVRFX0NPTlRST0xfREVGQVVMVF9QUk9NUFRfSU5WQUxJRF9WQUxVRV9XSVRIX1JFQVNPTicsIHsgcmVhc29uOiBhY3QucGF5bG9hZC5yZW5kZXJlZFJlYXNvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTE4bmV4dC50KCdEQVRFX0NPTlRST0xfREVGQVVMVF9QUk9NUFRfR0VORVJBTF9JTlZBTElEX1ZBTFVFJyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXF1ZXN0VmFsdWU6IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUFJPTVBUX1JFUVVFU1RfVkFMVUUnKSxcbiAgICAgICAgICAgICAgICByZXF1ZXN0Q2hhbmdlZFZhbHVlOiBpMThuZXh0LnQoJ0RBVEVfQ09OVFJPTF9ERUZBVUxUX1BST01QVF9SRVFVRVNUX0NIQU5HRURfVkFMVUUnKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXByb21wdHM6IHtcbiAgICAgICAgICAgICAgICBjb25maXJtVmFsdWU6IChhY3QpID0+IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUkVQUk9NUFRfQ09ORklSTV9WQUxVRScsIHsgdmFsdWU6IGFjdC5wYXlsb2FkLnZhbHVlIH0pLFxuICAgICAgICAgICAgICAgIHZhbHVlQWZmaXJtZWQ6IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUkVQUk9NUFRfVkFMVUVfQUZGSVJNRUQnKSxcbiAgICAgICAgICAgICAgICB2YWx1ZURpc2FmZmlybWVkOiBpMThuZXh0LnQoJ0RBVEVfQ09OVFJPTF9ERUZBVUxUX1JFUFJPTVBUX1ZBTFVFX0RJU0FGRklSTUVEJyksXG4gICAgICAgICAgICAgICAgdmFsdWVTZXQ6IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUkVQUk9NUFRfVkFMVUVfU0VUJyksXG4gICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkOiAoYWN0KSA9PiBpMThuZXh0LnQoJ0RBVEVfQ09OVFJPTF9ERUZBVUxUX1JFUFJPTVBUX1ZBTFVFX0NIQU5HRUQnLCB7IG9sZDogYWN0LnBheWxvYWQucHJldmlvdXNWYWx1ZSwgbmV3OiBhY3QucGF5bG9hZC52YWx1ZSB9KSxcbiAgICAgICAgICAgICAgICBpbnZhbGlkVmFsdWU6IChhY3QpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdC5wYXlsb2FkLnJlbmRlcmVkUmVhc29uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpMThuZXh0LnQoJ0RBVEVfQ09OVFJPTF9ERUZBVUxUX1JFUFJPTVBUX0lOVkFMSURfVkFMVUVfV0lUSF9SRUFTT04nLCB7IHJlYXNvbjogYWN0LnBheWxvYWQucmVuZGVyZWRSZWFzb24gfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUkVQUk9NUFRfR0VORVJBTF9JTlZBTElEX1ZBTFVFJyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXF1ZXN0VmFsdWU6IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUkVQUk9NUFRfUkVRVUVTVF9WQUxVRScpLFxuICAgICAgICAgICAgICAgIHJlcXVlc3RDaGFuZ2VkVmFsdWU6IGkxOG5leHQudCgnREFURV9DT05UUk9MX0RFRkFVTFRfUkVQUk9NUFRfUkVRVUVTVF9DSEFOR0VEX1ZBTFVFJyksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW50ZXJhY3Rpb25Nb2RlbDoge1xuICAgICAgICAgICAgICAgIGFjdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0OiBbJC5BY3Rpb24uU2V0XSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBbJC5BY3Rpb24uQ2hhbmdlXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRhcmdldHM6IFskLlRhcmdldC5EYXRlLCAkLlRhcmdldC5JdF1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB2YWxpZGF0aW9uOiBbXSxcbiAgICAgICAgICAgIGNvbmZpcm1hdGlvblJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIF8ubWVyZ2UoZGVmYXVsdHMsIHByb3BzKTtcbiAgICB9XG5cbiAgICAvLyB0c0RvYyAtIHNlZSBDb250cm9sXG4gICAgY2FuSGFuZGxlKGlucHV0OiBDb250cm9sSW5wdXQpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNTZXRXaXRoVmFsdWUoaW5wdXQpXG4gICAgICAgICAgICB8fCB0aGlzLmlzU2V0V2l0aG91dFZhbHVlKGlucHV0KVxuICAgICAgICAgICAgfHwgdGhpcy5pc0NoYW5nZVdpdGhWYWx1ZShpbnB1dClcbiAgICAgICAgICAgIHx8IHRoaXMuaXNDaGFuZ2VXaXRob3V0VmFsdWUoaW5wdXQpXG4gICAgICAgICAgICB8fCB0aGlzLmlzQmFyZVZhbHVlKGlucHV0KVxuICAgICAgICAgICAgfHwgdGhpcy5pc0NvbmZpcm1hdGlvbkFmZmlybWVkKGlucHV0KVxuICAgICAgICAgICAgfHwgdGhpcy5pc0NvbmZpcm1hdGlvbkRpc2FmZmlybWVkKGlucHV0KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGlzU2V0V2l0aFZhbHVlKGlucHV0OiBDb250cm9sSW5wdXQpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLmlzU2luZ2xlVmFsdWVDb250cm9sSW50ZW50KGlucHV0LCBBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSkpO1xuICAgICAgICAgICAgY29uc3QgeyBmZWVkYmFjaywgYWN0aW9uLCB0YXJnZXQsIHZhbHVlU3RyIH0gPSB1bnBhY2tTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQoKGlucHV0LnJlcXVlc3QgYXMgSW50ZW50UmVxdWVzdCkuaW50ZW50KTtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLmZlZWRiYWNrSXNNYXRjaE9yVW5kZWZpbmVkKGZlZWRiYWNrLCBbJC5GZWVkYmFjay5BZmZpcm0sICQuRmVlZGJhY2suRGlzYWZmaXJtXSkpO1xuICAgICAgICAgICAgb2tJZihJbnB1dFV0aWwuYWN0aW9uSXNNYXRjaChhY3Rpb24sIHRoaXMucHJvcHMuaW50ZXJhY3Rpb25Nb2RlbC5hY3Rpb25zLnNldCkpO1xuICAgICAgICAgICAgb2tJZihJbnB1dFV0aWwudGFyZ2V0SXNNYXRjaE9yVW5kZWZpbmVkKHRhcmdldCwgdGhpcy5wcm9wcy5pbnRlcmFjdGlvbk1vZGVsLnRhcmdldHMpKTtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLnZhbHVlU3RyRGVmaW5lZCh2YWx1ZVN0cikpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVGdW5jID0gdGhpcy5oYW5kbGVTZXRXaXRoVmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2VJZkd1YXJkRmFpbGVkKGUpOyB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVTZXRXaXRoVmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyB2YWx1ZVN0ciB9ID0gdW5wYWNrU2luZ2xlVmFsdWVDb250cm9sSW50ZW50KChpbnB1dC5yZXF1ZXN0IGFzIEludGVudFJlcXVlc3QpLmludGVudCk7XG4gICAgICAgIHRoaXMuc2V0VmFsdWUodmFsdWVTdHIpO1xuICAgICAgICB0aGlzLnZhbGlkYXRlQW5kQWRkQWN0cyhpbnB1dCwgcmVzdWx0QnVpbGRlciwgJC5BY3Rpb24uU2V0KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHByaXZhdGUgaXNTZXRXaXRob3V0VmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCk6IGJvb2xlYW4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgb2tJZihJbnB1dFV0aWwuaXNJbnRlbnQoaW5wdXQsIEdlbmVyYWxDb250cm9sSW50ZW50Lm5hbWUpKTtcbiAgICAgICAgICAgIGNvbnN0IHsgZmVlZGJhY2ssIGFjdGlvbiwgdGFyZ2V0IH0gPSB1bnBhY2tHZW5lcmFsQ29udHJvbEludGVudCgoaW5wdXQucmVxdWVzdCBhcyBJbnRlbnRSZXF1ZXN0KS5pbnRlbnQpO1xuICAgICAgICAgICAgb2tJZihJbnB1dFV0aWwuZmVlZGJhY2tJc01hdGNoT3JVbmRlZmluZWQoZmVlZGJhY2ssIFskLkZlZWRiYWNrLkFmZmlybSwgJC5GZWVkYmFjay5EaXNhZmZpcm1dKSk7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC5hY3Rpb25Jc01hdGNoKGFjdGlvbiwgdGhpcy5wcm9wcy5pbnRlcmFjdGlvbk1vZGVsLmFjdGlvbnMuc2V0KSk7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC50YXJnZXRJc01hdGNoT3JVbmRlZmluZWQodGFyZ2V0LCB0aGlzLnByb3BzLmludGVyYWN0aW9uTW9kZWwudGFyZ2V0cykpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVGdW5jID0gdGhpcy5oYW5kbGVTZXRXaXRob3V0VmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2VJZkd1YXJkRmFpbGVkKGUpOyB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVTZXRXaXRob3V0VmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hc2tFbGljaXRhdGlvblF1ZXN0aW9uKGlucHV0LCByZXN1bHRCdWlsZGVyLCAkLkFjdGlvbi5TZXQpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVzdCBpZiB0aGUgaW5wdXQgaXMgYSB2YWxpZCBjaGFuZ2UtYWN0aW9uIHdpdGggYSB2YWx1ZSBwcm92aWRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpbnB1dCAtIElucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBpc0NoYW5nZVdpdGhWYWx1ZShpbnB1dDogQ29udHJvbElucHV0KTogYm9vbGVhbiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC5pc1NpbmdsZVZhbHVlQ29udHJvbEludGVudChpbnB1dCwgQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUpKTtcbiAgICAgICAgICAgIGNvbnN0IHsgZmVlZGJhY2ssIGFjdGlvbiwgdGFyZ2V0LCB2YWx1ZVN0ciB9ID0gdW5wYWNrU2luZ2xlVmFsdWVDb250cm9sSW50ZW50KChpbnB1dC5yZXF1ZXN0IGFzIEludGVudFJlcXVlc3QpLmludGVudCk7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC5mZWVkYmFja0lzTWF0Y2hPclVuZGVmaW5lZChmZWVkYmFjaywgWyQuRmVlZGJhY2suQWZmaXJtLCAkLkZlZWRiYWNrLkRpc2FmZmlybV0pKTtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLmFjdGlvbklzTWF0Y2goYWN0aW9uLCB0aGlzLnByb3BzLmludGVyYWN0aW9uTW9kZWwuYWN0aW9ucy5jaGFuZ2UpKTtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLnRhcmdldElzTWF0Y2hPclVuZGVmaW5lZCh0YXJnZXQsIHRoaXMucHJvcHMuaW50ZXJhY3Rpb25Nb2RlbC50YXJnZXRzKSk7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC52YWx1ZVN0ckRlZmluZWQodmFsdWVTdHIpKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRnVuYyA9IHRoaXMuaGFuZGxlQ2hhbmdlV2l0aFZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlSWZHdWFyZEZhaWxlZChlKTsgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlQ2hhbmdlV2l0aFZhbHVlKGlucHV0OiBDb250cm9sSW5wdXQsIHJlc3VsdEJ1aWxkZXI6IENvbnRyb2xSZXN1bHRCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgdmFsdWVTdHIgfSA9IHVucGFja1NpbmdsZVZhbHVlQ29udHJvbEludGVudCgoaW5wdXQucmVxdWVzdCBhcyBJbnRlbnRSZXF1ZXN0KS5pbnRlbnQpO1xuICAgICAgICB0aGlzLnNldFZhbHVlKHZhbHVlU3RyKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZUFuZEFkZEFjdHMoaW5wdXQsIHJlc3VsdEJ1aWxkZXIsICQuQWN0aW9uLkNoYW5nZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUZXN0IGlmIHRoZSBpbnB1dCBpcyBhIHZhbGlkIGNoYW5nZS1hY3Rpb24gd2l0aG91dCBhIHZhbHVlIHByb3ZpZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIGlucHV0IC0gSW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGlzQ2hhbmdlV2l0aG91dFZhbHVlKGlucHV0OiBDb250cm9sSW5wdXQpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLmlzSW50ZW50KGlucHV0LCBHZW5lcmFsQ29udHJvbEludGVudC5uYW1lKSk7XG4gICAgICAgICAgICBjb25zdCB7IGZlZWRiYWNrLCBhY3Rpb24sIHRhcmdldCB9ID0gdW5wYWNrR2VuZXJhbENvbnRyb2xJbnRlbnQoKGlucHV0LnJlcXVlc3QgYXMgSW50ZW50UmVxdWVzdCkuaW50ZW50KTtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLmZlZWRiYWNrSXNNYXRjaE9yVW5kZWZpbmVkKGZlZWRiYWNrLCBbJC5GZWVkYmFjay5BZmZpcm0sICQuRmVlZGJhY2suRGlzYWZmaXJtXSkpO1xuICAgICAgICAgICAgb2tJZihJbnB1dFV0aWwuYWN0aW9uSXNNYXRjaChhY3Rpb24sIHRoaXMucHJvcHMuaW50ZXJhY3Rpb25Nb2RlbC5hY3Rpb25zLmNoYW5nZSkpO1xuICAgICAgICAgICAgb2tJZihJbnB1dFV0aWwudGFyZ2V0SXNNYXRjaE9yVW5kZWZpbmVkKHRhcmdldCwgdGhpcy5wcm9wcy5pbnRlcmFjdGlvbk1vZGVsLnRhcmdldHMpKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRnVuYyA9IHRoaXMuaGFuZGxlQ2hhbmdlV2l0aG91dFZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlSWZHdWFyZEZhaWxlZChlKTsgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlQ2hhbmdlV2l0aG91dFZhbHVlKGlucHV0OiBDb250cm9sSW5wdXQsIHJlc3VsdEJ1aWxkZXI6IENvbnRyb2xSZXN1bHRCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYXNrRWxpY2l0YXRpb25RdWVzdGlvbihpbnB1dCwgcmVzdWx0QnVpbGRlciwgJC5BY3Rpb24uQ2hhbmdlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlc3QgaWYgdGhlIGlucHV0IGlzIGEgRGF0ZUNvbnRyb2xJbnRlbnQgd2l0aCBqdXN0IGEgZGF0ZSBwcm92aWRlZC5cbiAgICAgKiBJZiB3ZSBhcmVuJ3QgYXNraW5nIGEgcXVlc3Rpb24gaXQgaXMgYXNzdW1lZCB0aGUgdXNlciBtZWFudCAnc2V0IHZhbHVlJy5cbiAgICAgKiBAcGFyYW0gaW5wdXQgLSBJbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgaXNCYXJlVmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCk6IGFueSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC5pc1NpbmdsZVZhbHVlQ29udHJvbEludGVudChpbnB1dCwgQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUpKTtcbiAgICAgICAgICAgIGNvbnN0IHsgZmVlZGJhY2ssIGFjdGlvbiwgdGFyZ2V0LCB2YWx1ZVN0ciB9ID0gdW5wYWNrU2luZ2xlVmFsdWVDb250cm9sSW50ZW50KChpbnB1dC5yZXF1ZXN0IGFzIEludGVudFJlcXVlc3QpLmludGVudCk7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC5mZWVkYmFja0lzVW5kZWZpbmVkKGZlZWRiYWNrKSk7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC5hY3Rpb25Jc1VuZGVmaW5lZChhY3Rpb24pKTtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLnRhcmdldElzTWF0Y2hPclVuZGVmaW5lZCh0YXJnZXQsIHRoaXMucHJvcHMuaW50ZXJhY3Rpb25Nb2RlbC50YXJnZXRzKSk7XG4gICAgICAgICAgICBva0lmKElucHV0VXRpbC52YWx1ZVN0ckRlZmluZWQodmFsdWVTdHIpKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRnVuYyA9IHRoaXMuaGFuZGxlQmFyZVZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlSWZHdWFyZEZhaWxlZChlKTsgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlQmFyZVZhbHVlKGlucHV0OiBDb250cm9sSW5wdXQsIHJlc3VsdEJ1aWxkZXI6IENvbnRyb2xSZXN1bHRCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgdmFsdWVTdHIgfSA9IHVucGFja1NpbmdsZVZhbHVlQ29udHJvbEludGVudCgoaW5wdXQucmVxdWVzdCBhcyBJbnRlbnRSZXF1ZXN0KS5pbnRlbnQpO1xuICAgICAgICB0aGlzLnNldFZhbHVlKHZhbHVlU3RyKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZUFuZEFkZEFjdHMoaW5wdXQsIHJlc3VsdEJ1aWxkZXIsIHRoaXMuc3RhdGUuZWxpY2l0YXRpb25BY3Rpb24gPz8gJC5BY3Rpb24uU2V0KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHByaXZhdGUgaXNDb25maXJtYXRpb25BZmZpcm1lZChpbnB1dDogQ29udHJvbElucHV0KTogYW55IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9rSWYoSW5wdXRVdGlsLmlzQmFyZVllcyhpbnB1dCkpO1xuICAgICAgICAgICAgb2tJZih0aGlzLnN0YXRlLmFjdGl2ZUluaXRpYXRpdmVBY3QgPT09ICdDb25maXJtVmFsdWVBY3QnKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRnVuYyA9IHRoaXMuaGFuZGxlQ29uZmlybWF0aW9uQWZmaXJtZWQ7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlSWZHdWFyZEZhaWxlZChlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlQ29uZmlybWF0aW9uQWZmaXJtZWQoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5hY3RpdmVJbml0aWF0aXZlQWN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnN0YXRlLmlzVmFsdWVDb25maXJtZWQgPSB0cnVlO1xuICAgICAgICByZXN1bHRCdWlsZGVyLmFkZEFjdChcbiAgICAgICAgICAgIG5ldyBWYWx1ZUNvbmZpcm1lZEFjdCh0aGlzLCB7IHZhbHVlOiB0aGlzLnN0YXRlLnZhbHVlIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0NvbmZpcm1hdGlvbkRpc2FmZmlybWVkKGlucHV0OiBDb250cm9sSW5wdXQpOiBhbnkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgb2tJZihJbnB1dFV0aWwuaXNCYXJlTm8oaW5wdXQpKTtcbiAgICAgICAgICAgIG9rSWYodGhpcy5zdGF0ZS5hY3RpdmVJbml0aWF0aXZlQWN0ID09PSAnQ29uZmlybVZhbHVlQWN0Jyk7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUZ1bmMgPSB0aGlzLmhhbmRsZUNvbmZpcm1hdGlvbkRpc2FmZmlybWVkO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZUlmR3VhcmRGYWlsZWQoZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZUNvbmZpcm1hdGlvbkRpc2FmZmlybWVkKGlucHV0OiBDb250cm9sSW5wdXQsIHJlc3VsdEJ1aWxkZXI6IENvbnRyb2xSZXN1bHRCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuaXNWYWx1ZUNvbmZpcm1lZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0YXRlLmFjdGl2ZUluaXRpYXRpdmVBY3QgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJlc3VsdEJ1aWxkZXIuYWRkQWN0KG5ldyBWYWx1ZURpc2NvbmZpcm1lZEFjdCh0aGlzLCB7dmFsdWU6IHRoaXMuc3RhdGUudmFsdWV9KSk7XG4gICAgICAgIHJlc3VsdEJ1aWxkZXIuYWRkQWN0KG5ldyBSZXF1ZXN0VmFsdWVBY3QodGhpcykpO1xuICAgIH1cblxuICAgIC8vIHRzRG9jIC0gc2VlIENvbnRyb2xcbiAgICBhc3luYyBoYW5kbGUoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpOiBQcm9taXNlPHZvaWQ+IHtcblxuICAgICAgICBsb2cuZGVidWcoYERhdGVDb250cm9sWyR7dGhpcy5pZH1dOiBoYW5kbGUoKS4gRW50ZXJpbmdgKTtcblxuICAgICAgICBpZiAodGhpcy5oYW5kbGVGdW5jID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGludGVudDogSW50ZW50ID0gKGlucHV0LnJlcXVlc3QgYXMgSW50ZW50UmVxdWVzdCkuaW50ZW50O1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke2ludGVudC5uYW1lfSBjYW4gbm90IGJlIGhhbmRsZWQgYnkgJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9LmApO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5oYW5kbGVGdW5jKGlucHV0LCByZXN1bHRCdWlsZGVyKTtcbiAgICAgICAgaWYgKHJlc3VsdEJ1aWxkZXIuaGFzSW5pdGlhdGl2ZUFjdCgpICE9PSB0cnVlICYmIHRoaXMuY2FuVGFrZUluaXRpYXRpdmUoaW5wdXQpID09PSB0cnVlKXtcbiAgICAgICAgICAgIHRoaXMudGFrZUluaXRpYXRpdmUoaW5wdXQsIHJlc3VsdEJ1aWxkZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gdHNEb2MgLSBzZWUgQ29udHJvbFxuICAgIGNhblRha2VJbml0aWF0aXZlKGlucHV0OiBDb250cm9sSW5wdXQpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud2FudHNUb0NvbmZpcm1WYWx1ZShpbnB1dClcbiAgICAgICAgICAgIHx8IHRoaXMud2FudHNUb0ZpeEludmFsaWRWYWx1ZShpbnB1dClcbiAgICAgICAgICAgIHx8IHRoaXMud2FudHNUb0VsaWNpdFZhbHVlKGlucHV0KTtcbiAgICB9XG5cbiAgICAvLyB0c0RvYyAtIHNlZSBDb250cm9sXG4gICAgdGFrZUluaXRpYXRpdmUoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaW5pdGlhdGl2ZUZ1bmMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNc2cgPSAnRGF0ZUNvbnRyb2w6IHRha2VJbml0aWF0aXZlIGNhbGxlZCBidXQgdGhpcy5pbml0aWF0aXZlRnVuYyBpcyBub3Qgc2V0LiBjYW5UYWtlSW5pdGlhdGl2ZSgpIHNob3VsZCBiZSBjYWxsZWQgZmlyc3QgdG8gc2V0IHRoaXMuaW5pdGlhdGl2ZUZ1bmMuJztcbiAgICAgICAgICAgIGxvZy5lcnJvcihlcnJvck1zZyk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNc2cpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdGlhdGl2ZUZ1bmMoaW5wdXQsIHJlc3VsdEJ1aWxkZXIpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB3YW50c1RvRWxpY2l0VmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS52YWx1ZSA9PT0gdW5kZWZpbmVkICYmIHRoaXMuZXZhbHVhdGVCb29sZWFuUHJvcCh0aGlzLnByb3BzLnJlcXVpcmVkLCBpbnB1dCkpe1xuICAgICAgICAgICAgdGhpcy5pbml0aWF0aXZlRnVuYyA9IHRoaXMuZWxpY2l0VmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBlbGljaXRWYWx1ZShpbnB1dDogQ29udHJvbElucHV0LCByZXN1bHRCdWlsZGVyOiBDb250cm9sUmVzdWx0QnVpbGRlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmFza0VsaWNpdGF0aW9uUXVlc3Rpb24oaW5wdXQsIHJlc3VsdEJ1aWxkZXIsICQuQWN0aW9uLlNldCk7XG4gICAgfVxuXG5cbiAgICAvLyBwdWJsaWMtZm9yLXRlc3RpbmdcbiAgICBhc2tFbGljaXRhdGlvblF1ZXN0aW9uKGlucHV0OiBDb250cm9sSW5wdXQsIHJlc3VsdEJ1aWxkZXI6IENvbnRyb2xSZXN1bHRCdWlsZGVyLCBlbGljaXRhdGlvbkFjdGlvbjogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc3RhdGUuZWxpY2l0YXRpb25BY3Rpb24gPSBlbGljaXRhdGlvbkFjdGlvbjtcbiAgICAgICAgc3dpdGNoIChlbGljaXRhdGlvbkFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAkLkFjdGlvbi5TZXQ6XG4gICAgICAgICAgICAgICAgcmVzdWx0QnVpbGRlci5hZGRBY3QobmV3IFJlcXVlc3RWYWx1ZUFjdCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY2FzZSAkLkFjdGlvbi5DaGFuZ2U6XG4gICAgICAgICAgICAgICAgcmVzdWx0QnVpbGRlci5hZGRBY3QobmV3IFJlcXVlc3RDaGFuZ2VkVmFsdWVBY3QodGhpcywge2N1cnJlbnRWYWx1ZTogdGhpcy5zdGF0ZS52YWx1ZSF9KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZC4gVW5rbm93biBlbGljaXRhdGlvbkFjdGlvbjogJHtlbGljaXRhdGlvbkFjdGlvbn1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdmFsaWRhdGVBbmRBZGRBY3RzKGlucHV0OiBDb250cm9sSW5wdXQsIHJlc3VsdEJ1aWxkZXI6IENvbnRyb2xSZXN1bHRCdWlsZGVyLCBlbGljaXRhdGlvbkFjdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuZWxpY2l0YXRpb25BY3Rpb24gPSBlbGljaXRhdGlvbkFjdGlvbjtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdDogdHJ1ZSB8IFZhbGlkYXRpb25SZXN1bHQgPSB0aGlzLnZhbGlkYXRlKGlucHV0KTtcbiAgICAgICAgaWYgKHZhbGlkYXRpb25SZXN1bHQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGlmIChlbGljaXRhdGlvbkFjdGlvbiA9PT0gJC5BY3Rpb24uQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgZWxpY2l0YXRpb25BY3Rpb24gPT0gJ2NoYW5nZScsIHRoZW4gdGhlIHByZXZpb3VzVmFsdWUgbXVzdCBiZSBkZWZpbmVkLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLnByZXZpb3VzVmFsdWUgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdEJ1aWxkZXIuYWRkQWN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFZhbHVlQ2hhbmdlZEFjdDxzdHJpbmc+KHRoaXMsIHtwcmV2aW91c1ZhbHVlOiB0aGlzLnN0YXRlLnByZXZpb3VzVmFsdWUsIHZhbHVlOiB0aGlzLnN0YXRlLnZhbHVlISB9KVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWYWx1ZUNoYW5nZWRBY3Qgc2hvdWxkIG9ubHkgYmUgdXNlZCBpZiB0aGVyZSBpcyBhbiBhY3R1YWwgcHJldmlvdXMgdmFsdWUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHRCdWlsZGVyLmFkZEFjdChuZXcgVmFsdWVTZXRBY3QodGhpcywgeyB2YWx1ZTogdGhpcy5zdGF0ZS52YWx1ZSB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBmZWVkYmFja1xuICAgICAgICAgICAgcmVzdWx0QnVpbGRlci5hZGRBY3QoXG4gICAgICAgICAgICAgICAgbmV3IEludmFsaWRWYWx1ZUFjdDxzdHJpbmc+KFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5zdGF0ZS52YWx1ZSEsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFzb25Db2RlOiB2YWxpZGF0aW9uUmVzdWx0LnJlYXNvbkNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlZFJlYXNvbjogdmFsaWRhdGlvblJlc3VsdC5yZW5kZXJlZFJlYXNvblxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuYXNrRWxpY2l0YXRpb25RdWVzdGlvbihpbnB1dCwgcmVzdWx0QnVpbGRlciwgZWxpY2l0YXRpb25BY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBwcml2YXRlIHdhbnRzVG9Db25maXJtVmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuc3RhdGUuaXNWYWx1ZUNvbmZpcm1lZCA9PT0gZmFsc2UgJiYgdGhpcy5ldmFsdWF0ZUJvb2xlYW5Qcm9wKHRoaXMucHJvcHMuY29uZmlybWF0aW9uUmVxdWlyZWQsIGlucHV0KSl7XG4gICAgICAgICAgICB0aGlzLmluaXRpYXRpdmVGdW5jID0gdGhpcy5jb25maXJtVmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjb25maXJtVmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5hY3RpdmVJbml0aWF0aXZlQWN0ID0gJ0NvbmZpcm1WYWx1ZUFjdCc7XG4gICAgICAgIHJlc3VsdEJ1aWxkZXIuYWRkQWN0KG5ldyBDb25maXJtVmFsdWVBY3QodGhpcywgeyB2YWx1ZTogdGhpcy5zdGF0ZS52YWx1ZSB9KSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB3YW50c1RvRml4SW52YWxpZFZhbHVlKGlucHV0OiBDb250cm9sSW5wdXQpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUudmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnZhbGlkYXRlKGlucHV0KSAhPT0gdHJ1ZSl7XG4gICAgICAgICAgICB0aGlzLmluaXRpYXRpdmVGdW5jID0gdGhpcy5maXhJbnZhbGlkVmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaXhJbnZhbGlkVmFsdWUoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzdWx0QnVpbGRlcjogQ29udHJvbFJlc3VsdEJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZUFuZEFkZEFjdHMoaW5wdXQsIHJlc3VsdEJ1aWxkZXIsICQuQWN0aW9uLkNoYW5nZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZShpbnB1dDogQ29udHJvbElucHV0KTogdHJ1ZSB8IFZhbGlkYXRpb25SZXN1bHQge1xuICAgICAgICBjb25zdCBsaXN0T2ZWYWxpZGF0aW9uRnVuYzogRGF0ZVZhbGlkYXRpb25GdW5jdGlvbltdID0gdHlwZW9mKHRoaXMucHJvcHMudmFsaWRhdGlvbikgPT09ICdmdW5jdGlvbicgPyBbdGhpcy5wcm9wcy52YWxpZGF0aW9uXSA6IHRoaXMucHJvcHMudmFsaWRhdGlvbjtcbiAgICAgICAgZm9yIChjb25zdCB2YWxpZGF0aW9uRnVuY3Rpb24gb2YgbGlzdE9mVmFsaWRhdGlvbkZ1bmMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQ6IHRydWUgfCBWYWxpZGF0aW9uUmVzdWx0ID0gdmFsaWRhdGlvbkZ1bmN0aW9uKHRoaXMuc3RhdGUsIGlucHV0KTtcbiAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uUmVzdWx0ICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgbG9nLmRlYnVnKGBEYXRlQ29udHJvbC52YWxpZGF0ZSgpOiB2YWxpZGF0aW9uIGZhaWxlZC4gUmVhc29uOiAke0pTT04uc3RyaW5naWZ5KHZhbGlkYXRpb25SZXN1bHQsIG51bGwsIDIpfS5gKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsaWRhdGlvblJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEaXJlY3RseSBzZXQgdGhlIHZhbHVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVmFsdWUsIGFuIElTTyBEYXRlIHN0cmluZ1xuICAgICAqL1xuICAgIHNldFZhbHVlKHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5wcmV2aW91c1ZhbHVlID0gdGhpcy5zdGF0ZS52YWx1ZTtcbiAgICAgICAgdGhpcy5zdGF0ZS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnN0YXRlLmlzVmFsdWVDb25maXJtZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciB0aGUgc3RhdGUgb2YgdGhpcyBjb250cm9sLlxuICAgICAqL1xuICAgIGNsZWFyKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gbmV3IERhdGVDb250cm9sU3RhdGUoKTtcbiAgICB9XG5cbiAgICAvLyB0c0RvYyAtIHNlZSBDb250cm9sXG4gICAgcmVuZGVyQWN0KGFjdDogU3lzdGVtQWN0LCBpbnB1dDogQ29udHJvbElucHV0LCBidWlsZGVyOiBDb250cm9sUmVzcG9uc2VCdWlsZGVyKTogdm9pZCB7XG5cbiAgICAgICAgaWYgKGFjdCBpbnN0YW5jZW9mIFJlcXVlc3RWYWx1ZUFjdCkge1xuICAgICAgICAgICAgYnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudCh0aGlzLmV2YWx1YXRlUHJvbXB0UHJvcChhY3QsIHRoaXMucHJvcHMucHJvbXB0cy5yZXF1ZXN0VmFsdWUsIGlucHV0KSk7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFJlcHJvbXB0RnJhZ21lbnQodGhpcy5ldmFsdWF0ZVByb21wdFByb3AoYWN0LCB0aGlzLnByb3BzLnJlcHJvbXB0cy5yZXF1ZXN0VmFsdWUsIGlucHV0KSk7XG4gICAgICAgICAgICBjb25zdCBzbG90RWxpY2l0YXRpb24gPSBnZW5lcmF0ZVNsb3RFbGljaXRhdGlvbigpO1xuICAgICAgICAgICAgYnVpbGRlci5hZGRFbGljaXRTbG90RGlyZWN0aXZlKHNsb3RFbGljaXRhdGlvbi5zbG90TmFtZSwgc2xvdEVsaWNpdGF0aW9uLmludGVudCk7XG4gICAgICAgIH1cblxuICAgICAgICBlbHNlIGlmIChhY3QgaW5zdGFuY2VvZiBWYWx1ZVNldEFjdCkge1xuICAgICAgICAgICAgYnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudCh0aGlzLmV2YWx1YXRlUHJvbXB0UHJvcChhY3QsIHRoaXMucHJvcHMucHJvbXB0cy52YWx1ZVNldCwgaW5wdXQpKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkUmVwcm9tcHRGcmFnbWVudCh0aGlzLmV2YWx1YXRlUHJvbXB0UHJvcChhY3QsIHRoaXMucHJvcHMucmVwcm9tcHRzLnZhbHVlU2V0LCBpbnB1dCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxzZSBpZiAoYWN0IGluc3RhbmNlb2YgVmFsdWVDaGFuZ2VkQWN0KSB7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFByb21wdEZyYWdtZW50KHRoaXMuZXZhbHVhdGVQcm9tcHRQcm9wKGFjdCwgdGhpcy5wcm9wcy5wcm9tcHRzLnZhbHVlQ2hhbmdlZCwgaW5wdXQpKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkUmVwcm9tcHRGcmFnbWVudCh0aGlzLmV2YWx1YXRlUHJvbXB0UHJvcChhY3QsIHRoaXMucHJvcHMucmVwcm9tcHRzLnZhbHVlQ2hhbmdlZCwgaW5wdXQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsc2UgaWYgKGFjdCBpbnN0YW5jZW9mIEludmFsaWRWYWx1ZUFjdCkge1xuICAgICAgICAgICAgYnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudCh0aGlzLmV2YWx1YXRlUHJvbXB0UHJvcChhY3QsIHRoaXMucHJvcHMucHJvbXB0cy5pbnZhbGlkVmFsdWUsIGlucHV0KSk7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFJlcHJvbXB0RnJhZ21lbnQodGhpcy5ldmFsdWF0ZVByb21wdFByb3AoYWN0LCB0aGlzLnByb3BzLnJlcHJvbXB0cy5pbnZhbGlkVmFsdWUsIGlucHV0KSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbHNlIGlmIChhY3QgaW5zdGFuY2VvZiBSZXF1ZXN0Q2hhbmdlZFZhbHVlQWN0KSB7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFByb21wdEZyYWdtZW50KHRoaXMuZXZhbHVhdGVQcm9tcHRQcm9wKGFjdCwgdGhpcy5wcm9wcy5wcm9tcHRzLnJlcXVlc3RDaGFuZ2VkVmFsdWUsIGlucHV0KSk7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFJlcHJvbXB0RnJhZ21lbnQodGhpcy5ldmFsdWF0ZVByb21wdFByb3AoYWN0LCB0aGlzLnByb3BzLnJlcHJvbXB0cy5yZXF1ZXN0Q2hhbmdlZFZhbHVlLCBpbnB1dCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxzZSBpZiAoYWN0IGluc3RhbmNlb2YgQ29uZmlybVZhbHVlQWN0KSB7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFByb21wdEZyYWdtZW50KHRoaXMuZXZhbHVhdGVQcm9tcHRQcm9wKGFjdCwgdGhpcy5wcm9wcy5wcm9tcHRzLmNvbmZpcm1WYWx1ZSwgaW5wdXQpKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkUmVwcm9tcHRGcmFnbWVudCh0aGlzLmV2YWx1YXRlUHJvbXB0UHJvcChhY3QsIHRoaXMucHJvcHMucmVwcm9tcHRzLmNvbmZpcm1WYWx1ZSwgaW5wdXQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsc2UgaWYgKGFjdCBpbnN0YW5jZW9mIFZhbHVlQ29uZmlybWVkQWN0KSB7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFByb21wdEZyYWdtZW50KHRoaXMuZXZhbHVhdGVQcm9tcHRQcm9wKGFjdCwgdGhpcy5wcm9wcy5wcm9tcHRzLnZhbHVlQWZmaXJtZWQsIGlucHV0KSk7XG4gICAgICAgICAgICBidWlsZGVyLmFkZFJlcHJvbXB0RnJhZ21lbnQodGhpcy5ldmFsdWF0ZVByb21wdFByb3AoYWN0LCB0aGlzLnByb3BzLnJlcHJvbXB0cy52YWx1ZUFmZmlybWVkLCBpbnB1dCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxzZSBpZiAoYWN0IGluc3RhbmNlb2YgVmFsdWVEaXNjb25maXJtZWRBY3QpIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkUHJvbXB0RnJhZ21lbnQodGhpcy5ldmFsdWF0ZVByb21wdFByb3AoYWN0LCB0aGlzLnByb3BzLnByb21wdHMudmFsdWVEaXNhZmZpcm1lZCwgaW5wdXQpKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkUmVwcm9tcHRGcmFnbWVudCh0aGlzLmV2YWx1YXRlUHJvbXB0UHJvcChhY3QsIHRoaXMucHJvcHMucmVwcm9tcHRzLnZhbHVlRGlzYWZmaXJtZWQsIGlucHV0KSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGhyb3dVbmhhbmRsZWRBY3RFcnJvcihhY3QpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gdHNEb2MgLSBzZWUgQ29udHJvbFxuICAgIHVwZGF0ZUludGVyYWN0aW9uTW9kZWwoZ2VuZXJhdG9yOiBDb250cm9sSW50ZXJhY3Rpb25Nb2RlbEdlbmVyYXRvciwgaW1EYXRhOiBNb2RlbERhdGEpIHtcbiAgICAgICAgZ2VuZXJhdG9yLmFkZENvbnRyb2xJbnRlbnQobmV3IEdlbmVyYWxDb250cm9sSW50ZW50KCksIGltRGF0YSk7XG4gICAgICAgIGdlbmVyYXRvci5hZGRDb250cm9sSW50ZW50KG5ldyBTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUpLCBpbURhdGEpO1xuICAgICAgICBnZW5lcmF0b3IuYWRkWWVzQW5kTm9JbnRlbnRzKCk7XG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMuaW50ZXJhY3Rpb25Nb2RlbC50YXJnZXRzLmluY2x1ZGVzKCdkYXRlJykpIHtcbiAgICAgICAgICAgIGdlbmVyYXRvci5hZGRWYWx1ZXNUb1Nsb3RUeXBlKFNoYXJlZFNsb3RUeXBlLlRBUkdFVCwgaTE4bmV4dC50KCdEQVRFX0NPTlRST0xfREVGQVVMVF9TTE9UX1ZBTFVFU19UQVJHRVRfREFURScsIHsgcmV0dXJuT2JqZWN0czogdHJ1ZSB9KSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyB0c0RvYyAtIHNlZSBJbnRlcmFjdGlvbk1vZGVsQ29udHJpYnV0b3JcbiAgICBnZXRUYXJnZXRJZHMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pbnRlcmFjdGlvbk1vZGVsLnRhcmdldHM7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gZWxpY2l0LXNsb3QgZGlyZWN0aXZlLlxuICpcbiAqIC0gVGhlIGludGVudCBzcGVjaWZpZWQgaXMgYSBgQU1BWk9OX0RBVEVfVmFsdWVDb250cm9sSW50ZW50YFxuICogLSBUaGUgc2xvdCBzcGVjaWZpZWQgaXMgdGhlIGBBTUFaT04uREFURWAgc2xvdC5cbiAqXG4gKiBAcGFyYW0gc2xvdFR5cGUgLSBTbG90IHR5cGVcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVTbG90RWxpY2l0YXRpb24oKTogeyBpbnRlbnQ6IEludGVudCwgc2xvdE5hbWU6IHN0cmluZyB9IHtcbiAgICBjb25zdCBpbnRlbnQ6IEludGVudCA9IHtcbiAgICAgICAgbmFtZTogU2luZ2xlVmFsdWVDb250cm9sSW50ZW50LmludGVudE5hbWUoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUpLFxuICAgICAgICBzbG90czoge1xuICAgICAgICAgICAgXCJmZWVkYmFja1wiOiB7IG5hbWU6IFwiZmVlZGJhY2tcIiwgdmFsdWU6ICcnLCBjb25maXJtYXRpb25TdGF0dXM6ICdOT05FJyB9LFxuICAgICAgICAgICAgXCJhY3Rpb25cIjogeyBuYW1lOiBcImFjdGlvblwiLCB2YWx1ZTogJycsIGNvbmZpcm1hdGlvblN0YXR1czogJ05PTkUnIH0sXG4gICAgICAgICAgICBcInRhcmdldFwiOiB7IG5hbWU6IFwidGFyZ2V0XCIsIHZhbHVlOiAnJywgY29uZmlybWF0aW9uU3RhdHVzOiAnTk9ORScgfSxcbiAgICAgICAgICAgIFwiQU1BWk9OLkRBVEVcIjogeyBuYW1lOiBcIkFNQVpPTi5EQVRFXCIsIHZhbHVlOiAnJywgY29uZmlybWF0aW9uU3RhdHVzOiAnTk9ORScgfSxcbiAgICAgICAgICAgIFwiaGVhZFwiOiB7IG5hbWU6IFwiaGVhZFwiLCB2YWx1ZTogJycsIGNvbmZpcm1hdGlvblN0YXR1czogJ05PTkUnIH0sXG4gICAgICAgICAgICBcInRhaWxcIjogeyBuYW1lOiBcInRhaWxcIiwgdmFsdWU6ICcnLCBjb25maXJtYXRpb25TdGF0dXM6ICdOT05FJyB9LFxuICAgICAgICAgICAgXCJwcmVwb3NpdGlvblwiOiB7IG5hbWU6IFwicHJlcG9zaXRpb25cIiwgdmFsdWU6ICcnLCBjb25maXJtYXRpb25TdGF0dXM6ICdOT05FJyB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbmZpcm1hdGlvblN0YXR1czogXCJOT05FXCJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW50ZW50LFxuICAgICAgICBzbG90TmFtZTogQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEVcbiAgICB9O1xufVxuIl19