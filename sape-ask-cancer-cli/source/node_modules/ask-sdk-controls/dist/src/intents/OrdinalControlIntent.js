"use strict";
/*
 * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License").
 * You may not use this file except in compliance with the License.
 * A copy of the License is located at
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * or in the "license" file accompanying this file. This file is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.OrdinalControlIntent = exports.unpackOrdinalControlIntent = void 0;
const ModelTypes_1 = require("../interactionModelGeneration/ModelTypes");
const IntentUtils_1 = require("../utils/IntentUtils");
const AmazonBuiltInSlotType_1 = require("./AmazonBuiltInSlotType");
const BaseControlIntent_1 = require("./BaseControlIntent");
/**
 * Unpacks the complete intent object into a simpler representation.
 *
 * Note re "empty slots":
 * - Slots in the intent with no value appear in the intent object as "".
 *   However, these are unpacked as **`undefined`** to be more explicit and ease
 *   the implementation of predicates.
 * @param intent - Intent
 */
function unpackOrdinalControlIntent(intent) {
    if (!intent.name.startsWith('OrdinalControlIntent')) {
        throw new Error(`Not a compatible intent: ${intent.name}`);
    }
    let action;
    let feedback;
    let target;
    let valueStr;
    for (const [name, slot] of Object.entries(intent.slots)) {
        const slotObject = IntentUtils_1.getSlotResolutions(slot);
        const slotValue = slotObject ? slotObject.slotValue : undefined;
        switch (name) {
            case 'feedback':
                feedback = slotValue !== undefined ? slotValue : undefined;
                break;
            case 'action':
                action = slotValue !== undefined ? slotValue : undefined;
                break;
            case 'target':
                target = slotValue !== undefined ? slotValue : undefined;
                break;
            case 'AMAZON.Ordinal':
                valueStr = slotValue !== undefined ? slotValue : undefined;
                break;
            // default: ignore content-free slots
        }
    }
    return {
        feedback,
        action,
        target,
        'AMAZON.Ordinal': valueStr
    };
}
exports.unpackOrdinalControlIntent = unpackOrdinalControlIntent;
/**
 * Intent that conveys feedback, action, target and an AMAZON.Ordinal value
 *
 * This general-purpose intent conveys the intent for utterances such as:
 * - "The time"
 * - "Change the date"
 * - "Yes, that one"
 * - "No, change the event date"
 */
class OrdinalControlIntent extends BaseControlIntent_1.BaseControlIntent {
    /**
     * Create Intent from specification of the slots
     */
    static of(slots) {
        return IntentUtils_1.IntentBuilder.of(this.prototype.constructor.name, slots);
    }
    // tsDoc: see BaseControlIntent
    generateIntent() {
        return {
            name: this.name,
            slots: this.generateSlots(),
            samples: [],
        };
    }
    generateSlots() {
        const slots = [
            {
                name: 'feedback',
                type: ModelTypes_1.SharedSlotType.FEEDBACK
            },
            {
                name: 'action',
                type: ModelTypes_1.SharedSlotType.ACTION
            },
            {
                name: 'target',
                type: ModelTypes_1.SharedSlotType.TARGET
            },
            {
                name: 'AMAZON.Ordinal',
                type: AmazonBuiltInSlotType_1.AmazonBuiltInSlotType.ORDINAL
            },
            {
                name: 'preposition',
                type: ModelTypes_1.SharedSlotType.PREPOSITION
            },
            {
                name: 'head',
                type: ModelTypes_1.SharedSlotType.HEAD
            },
            {
                name: 'tail',
                type: ModelTypes_1.SharedSlotType.TAIL
            }
        ];
        return slots;
    }
}
exports.OrdinalControlIntent = OrdinalControlIntent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT3JkaW5hbENvbnRyb2xJbnRlbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvaW50ZW50cy9PcmRpbmFsQ29udHJvbEludGVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7O0dBV0c7OztBQUlILHlFQUEwRTtBQUMxRSxzREFBeUU7QUFDekUsbUVBQWdFO0FBQ2hFLDJEQUF3RDtBQWF4RDs7Ozs7Ozs7R0FRRztBQUNILFNBQWdCLDBCQUEwQixDQUFDLE1BQWM7SUFDckQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLHNCQUFzQixDQUFDLEVBQUU7UUFDakQsTUFBTSxJQUFJLEtBQUssQ0FBQyw0QkFBNEIsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7S0FDOUQ7SUFFRCxJQUFJLE1BQTBCLENBQUM7SUFDL0IsSUFBSSxRQUE0QixDQUFDO0lBQ2pDLElBQUksTUFBMEIsQ0FBQztJQUMvQixJQUFJLFFBQTRCLENBQUM7SUFFakMsS0FBSyxNQUFNLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQU0sQ0FBQyxFQUFFO1FBQ3RELE1BQU0sVUFBVSxHQUFHLGdDQUFrQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVDLE1BQU0sU0FBUyxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBRWhFLFFBQVEsSUFBSSxFQUFFO1lBQ1YsS0FBSyxVQUFVO2dCQUFFLFFBQVEsR0FBRyxTQUFTLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztnQkFBQyxNQUFNO1lBQ25GLEtBQUssUUFBUTtnQkFBRSxNQUFNLEdBQUcsU0FBUyxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7Z0JBQUMsTUFBTTtZQUMvRSxLQUFLLFFBQVE7Z0JBQUUsTUFBTSxHQUFHLFNBQVMsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO2dCQUFDLE1BQU07WUFDL0UsS0FBSyxnQkFBZ0I7Z0JBQUUsUUFBUSxHQUFHLFNBQVMsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO2dCQUFDLE1BQU07WUFDekYscUNBQXFDO1NBQ3hDO0tBQ0o7SUFFRCxPQUFPO1FBQ0gsUUFBUTtRQUNSLE1BQU07UUFDTixNQUFNO1FBQ04sZ0JBQWdCLEVBQUUsUUFBUTtLQUM3QixDQUFDO0FBQ04sQ0FBQztBQTdCRCxnRUE2QkM7QUFFRDs7Ozs7Ozs7R0FRRztBQUNILE1BQWEsb0JBQXFCLFNBQVEscUNBQWlCO0lBRXZEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFnQztRQUN0QyxPQUFPLDJCQUFhLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztJQUNwRSxDQUFDO0lBRUQsK0JBQStCO0lBQy9CLGNBQWM7UUFDVixPQUFPO1lBQ0gsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO1lBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDM0IsT0FBTyxFQUFFLEVBQUU7U0FDZCxDQUFDO0lBQ04sQ0FBQztJQUVPLGFBQWE7UUFDakIsTUFBTSxLQUFLLEdBQStDO1lBQ3REO2dCQUNJLElBQUksRUFBRSxVQUFVO2dCQUNoQixJQUFJLEVBQUUsMkJBQWMsQ0FBQyxRQUFRO2FBQ2hDO1lBQ0Q7Z0JBQ0ksSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsSUFBSSxFQUFFLDJCQUFjLENBQUMsTUFBTTthQUM5QjtZQUNEO2dCQUNJLElBQUksRUFBRSxRQUFRO2dCQUNkLElBQUksRUFBRSwyQkFBYyxDQUFDLE1BQU07YUFDOUI7WUFDRDtnQkFDSSxJQUFJLEVBQUUsZ0JBQWdCO2dCQUN0QixJQUFJLEVBQUUsNkNBQXFCLENBQUMsT0FBTzthQUN0QztZQUNEO2dCQUNJLElBQUksRUFBRSxhQUFhO2dCQUNuQixJQUFJLEVBQUUsMkJBQWMsQ0FBQyxXQUFXO2FBQ25DO1lBQ0Q7Z0JBQ0ksSUFBSSxFQUFFLE1BQU07Z0JBQ1osSUFBSSxFQUFFLDJCQUFjLENBQUMsSUFBSTthQUM1QjtZQUNEO2dCQUNJLElBQUksRUFBRSxNQUFNO2dCQUNaLElBQUksRUFBRSwyQkFBYyxDQUFDLElBQUk7YUFDNUI7U0FDSixDQUFDO1FBRUYsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQztDQUNKO0FBcERELG9EQW9EQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAyMCBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS5cbiAqIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIG9yIGluIHRoZSBcImxpY2Vuc2VcIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZFxuICogb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyXG4gKiBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZ1xuICogcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEludGVudCB9IGZyb20gXCJhc2stc2RrLW1vZGVsXCI7XG5pbXBvcnQgeyB2MSB9IGZyb20gJ2Fzay1zbWFwaS1tb2RlbCc7XG5pbXBvcnQgeyBTaGFyZWRTbG90VHlwZSB9IGZyb20gJy4uL2ludGVyYWN0aW9uTW9kZWxHZW5lcmF0aW9uL01vZGVsVHlwZXMnO1xuaW1wb3J0IHsgZ2V0U2xvdFJlc29sdXRpb25zLCBJbnRlbnRCdWlsZGVyIH0gZnJvbSAnLi4vdXRpbHMvSW50ZW50VXRpbHMnO1xuaW1wb3J0IHsgQW1hem9uQnVpbHRJblNsb3RUeXBlIH0gZnJvbSAnLi9BbWF6b25CdWlsdEluU2xvdFR5cGUnO1xuaW1wb3J0IHsgQmFzZUNvbnRyb2xJbnRlbnQgfSBmcm9tICcuL0Jhc2VDb250cm9sSW50ZW50JztcblxuXG4vKipcbiAqIFNsb3QgdmFsdWVzIGNvbnZleWVkIGJ5IGEgT3JkaW5hbENvbnRyb2xJbnRlbnRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBPcmRpbmFsQ29udHJvbEludGVudFNsb3RzIHtcbiAgICBmZWVkYmFjaz86IHN0cmluZztcbiAgICBhY3Rpb24/OiBzdHJpbmc7XG4gICAgdGFyZ2V0Pzogc3RyaW5nO1xuICAgICdBTUFaT04uT3JkaW5hbCc/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogVW5wYWNrcyB0aGUgY29tcGxldGUgaW50ZW50IG9iamVjdCBpbnRvIGEgc2ltcGxlciByZXByZXNlbnRhdGlvbi5cbiAqXG4gKiBOb3RlIHJlIFwiZW1wdHkgc2xvdHNcIjpcbiAqIC0gU2xvdHMgaW4gdGhlIGludGVudCB3aXRoIG5vIHZhbHVlIGFwcGVhciBpbiB0aGUgaW50ZW50IG9iamVjdCBhcyBcIlwiLlxuICogICBIb3dldmVyLCB0aGVzZSBhcmUgdW5wYWNrZWQgYXMgKipgdW5kZWZpbmVkYCoqIHRvIGJlIG1vcmUgZXhwbGljaXQgYW5kIGVhc2VcbiAqICAgdGhlIGltcGxlbWVudGF0aW9uIG9mIHByZWRpY2F0ZXMuXG4gKiBAcGFyYW0gaW50ZW50IC0gSW50ZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bnBhY2tPcmRpbmFsQ29udHJvbEludGVudChpbnRlbnQ6IEludGVudCk6IE9yZGluYWxDb250cm9sSW50ZW50U2xvdHMge1xuICAgIGlmICghaW50ZW50Lm5hbWUuc3RhcnRzV2l0aCgnT3JkaW5hbENvbnRyb2xJbnRlbnQnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vdCBhIGNvbXBhdGlibGUgaW50ZW50OiAke2ludGVudC5uYW1lfWApO1xuICAgIH1cblxuICAgIGxldCBhY3Rpb246IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICBsZXQgZmVlZGJhY2s6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICBsZXQgdGFyZ2V0OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgbGV0IHZhbHVlU3RyOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgICBmb3IgKGNvbnN0IFtuYW1lLCBzbG90XSBvZiBPYmplY3QuZW50cmllcyhpbnRlbnQuc2xvdHMhKSkge1xuICAgICAgICBjb25zdCBzbG90T2JqZWN0ID0gZ2V0U2xvdFJlc29sdXRpb25zKHNsb3QpO1xuICAgICAgICBjb25zdCBzbG90VmFsdWUgPSBzbG90T2JqZWN0ID8gc2xvdE9iamVjdC5zbG90VmFsdWUgOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgc3dpdGNoIChuYW1lKSB7XG4gICAgICAgICAgICBjYXNlICdmZWVkYmFjayc6IGZlZWRiYWNrID0gc2xvdFZhbHVlICE9PSB1bmRlZmluZWQgPyBzbG90VmFsdWUgOiB1bmRlZmluZWQ7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYWN0aW9uJzogYWN0aW9uID0gc2xvdFZhbHVlICE9PSB1bmRlZmluZWQgPyBzbG90VmFsdWUgOiB1bmRlZmluZWQ7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndGFyZ2V0JzogdGFyZ2V0ID0gc2xvdFZhbHVlICE9PSB1bmRlZmluZWQgPyBzbG90VmFsdWUgOiB1bmRlZmluZWQ7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnQU1BWk9OLk9yZGluYWwnOiB2YWx1ZVN0ciA9IHNsb3RWYWx1ZSAhPT0gdW5kZWZpbmVkID8gc2xvdFZhbHVlIDogdW5kZWZpbmVkOyBicmVhaztcbiAgICAgICAgICAgIC8vIGRlZmF1bHQ6IGlnbm9yZSBjb250ZW50LWZyZWUgc2xvdHNcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGZlZWRiYWNrLFxuICAgICAgICBhY3Rpb24sXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgJ0FNQVpPTi5PcmRpbmFsJzogdmFsdWVTdHJcbiAgICB9O1xufVxuXG4vKipcbiAqIEludGVudCB0aGF0IGNvbnZleXMgZmVlZGJhY2ssIGFjdGlvbiwgdGFyZ2V0IGFuZCBhbiBBTUFaT04uT3JkaW5hbCB2YWx1ZVxuICpcbiAqIFRoaXMgZ2VuZXJhbC1wdXJwb3NlIGludGVudCBjb252ZXlzIHRoZSBpbnRlbnQgZm9yIHV0dGVyYW5jZXMgc3VjaCBhczpcbiAqIC0gXCJUaGUgdGltZVwiXG4gKiAtIFwiQ2hhbmdlIHRoZSBkYXRlXCJcbiAqIC0gXCJZZXMsIHRoYXQgb25lXCJcbiAqIC0gXCJObywgY2hhbmdlIHRoZSBldmVudCBkYXRlXCJcbiAqL1xuZXhwb3J0IGNsYXNzIE9yZGluYWxDb250cm9sSW50ZW50IGV4dGVuZHMgQmFzZUNvbnRyb2xJbnRlbnQge1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIEludGVudCBmcm9tIHNwZWNpZmljYXRpb24gb2YgdGhlIHNsb3RzXG4gICAgICovXG4gICAgc3RhdGljIG9mKHNsb3RzOiBPcmRpbmFsQ29udHJvbEludGVudFNsb3RzKTogSW50ZW50IHtcbiAgICAgICAgcmV0dXJuIEludGVudEJ1aWxkZXIub2YodGhpcy5wcm90b3R5cGUuY29uc3RydWN0b3IubmFtZSwgc2xvdHMpO1xuICAgIH1cblxuICAgIC8vIHRzRG9jOiBzZWUgQmFzZUNvbnRyb2xJbnRlbnRcbiAgICBnZW5lcmF0ZUludGVudCgpOiB2MS5za2lsbC5pbnRlcmFjdGlvbk1vZGVsLkludGVudCB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICAgICAgICBzbG90czogdGhpcy5nZW5lcmF0ZVNsb3RzKCksXG4gICAgICAgICAgICBzYW1wbGVzOiBbXSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdlbmVyYXRlU2xvdHMoKTogdjEuc2tpbGwuaW50ZXJhY3Rpb25Nb2RlbC5TbG90RGVmaW5pdGlvbltdIHtcbiAgICAgICAgY29uc3Qgc2xvdHM6IHYxLnNraWxsLmludGVyYWN0aW9uTW9kZWwuU2xvdERlZmluaXRpb25bXSA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnZmVlZGJhY2snLFxuICAgICAgICAgICAgICAgIHR5cGU6IFNoYXJlZFNsb3RUeXBlLkZFRURCQUNLXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdhY3Rpb24nLFxuICAgICAgICAgICAgICAgIHR5cGU6IFNoYXJlZFNsb3RUeXBlLkFDVElPTlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAndGFyZ2V0JyxcbiAgICAgICAgICAgICAgICB0eXBlOiBTaGFyZWRTbG90VHlwZS5UQVJHRVRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0FNQVpPTi5PcmRpbmFsJyxcbiAgICAgICAgICAgICAgICB0eXBlOiBBbWF6b25CdWlsdEluU2xvdFR5cGUuT1JESU5BTFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAncHJlcG9zaXRpb24nLFxuICAgICAgICAgICAgICAgIHR5cGU6IFNoYXJlZFNsb3RUeXBlLlBSRVBPU0lUSU9OXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdoZWFkJyxcbiAgICAgICAgICAgICAgICB0eXBlOiBTaGFyZWRTbG90VHlwZS5IRUFEXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICd0YWlsJyxcbiAgICAgICAgICAgICAgICB0eXBlOiBTaGFyZWRTbG90VHlwZS5UQUlMXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIHNsb3RzO1xuICAgIH1cbn1cbiJdfQ==